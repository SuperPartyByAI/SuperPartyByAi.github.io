<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>SuperParty</title>
  <style>
    :root {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --bg: #f8fafc;
      --card: #ffffff;
      --text: #1e293b;
      --text-soft: #64748b;
      --border: #e2e8f0;
      --radius: 12px;
      --success: #10B981;
      --warning: #F59E0B;
      --error: #EF4444;
      --purple: #8b5cf6;
      --purple-dark: #7c3aed;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
    }

    /* SIDEBAR */
    .sidebar {
      position: fixed;
      left: 0;
      top: 0;
      width: 260px;
      height: 100vh;
      background: var(--card);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      z-index: 100;
      transition: transform 0.3s;
      overflow-y: auto;
    }

    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon { font-size: 28px; }
    .logo-text { font-weight: 700; font-size: 18px; }

    .sidebar-nav {
      flex: 1;
      overflow-y: auto;
      padding: 15px 0;
    }

    .nav-section { margin-bottom: 20px; }
    
    .nav-section-title {
      padding: 8px 20px;
      font-size: 11px;
      font-weight: 600;
      color: var(--text-soft);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .nav-item {
      padding: 12px 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: all 0.15s;
      color: var(--text);
    }

    .nav-item:hover { background: var(--bg); }
    .nav-item.active { background: var(--primary); color: white; }
    .nav-item .icon { font-size: 18px; width: 24px; text-align: center; }

    /* MAIN */
    .main { margin-left: 260px; min-height: 100vh; }

    .header {
      background: var(--card);
      border-bottom: 1px solid var(--border);
      padding: 15px 25px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 50;
    }

    .menu-toggle {
      display: none;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      padding: 5px;
    }

    .page-title { font-size: 20px; font-weight: 600; }

    .content { padding: 25px; max-width: 1400px; }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    .card-title {
      font-weight: 600;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .welcome-card {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      border-radius: var(--radius);
      padding: 30px;
      margin-bottom: 25px;
    }

    .welcome-card h2 { margin-bottom: 8px; }
    .welcome-card p { opacity: 0.9; }

    .empty-state {
      text-align: center;
      padding: 40px;
      color: var(--text-soft);
    }

    .btn {
      padding: 10px 20px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.15s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary { background: var(--primary); color: white; }
    .btn-primary:hover { background: var(--primary-dark); }
    .btn-success { background: var(--success); color: white; }
    .btn-warning { background: var(--warning); color: white; }
    .btn-error { background: var(--error); color: white; }
    .btn-secondary { background: var(--bg); color: var(--text); }
    .btn-purple { background: var(--purple); color: white; }
    .btn-purple:hover { background: var(--purple-dark); }

    /* TABLE */
    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    .data-table th, .data-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    .data-table th {
      font-weight: 600;
      background: var(--bg);
    }

    .data-table tr:hover { background: var(--bg); }

    /* TABS */
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      border-bottom: 2px solid var(--border);
      flex-wrap: wrap;
    }

    .tab {
      padding: 12px 20px;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      margin-bottom: -2px;
      transition: all 0.2s;
      font-weight: 500;
    }

    .tab:hover { background: var(--bg); }
    .tab.active { border-bottom-color: var(--primary); color: var(--primary); }

    /* INPUTS */
    .input, .textarea, .select {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 14px;
      font-family: inherit;
      transition: border-color 0.2s;
    }

    .input:focus, .textarea:focus, .select:focus {
      outline: none;
      border-color: var(--primary);
    }

    .textarea {
      min-height: 120px;
      resize: vertical;
    }

    /* STATS GRID */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .stat-card {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      padding: 20px;
      border-radius: var(--radius);
    }

    .stat-card.green { background: linear-gradient(135deg, #10B981, #059669); }
    .stat-card.purple { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
    .stat-card.orange { background: linear-gradient(135deg, #f59e0b, #d97706); }
    .stat-card.red { background: linear-gradient(135deg, #ef4444, #dc2626); }

    .stat-value {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 14px;
      opacity: 0.9;
    }

    .stat-change {
      font-size: 12px;
      margin-top: 5px;
      opacity: 0.8;
    }

    /* BADGES */
    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
    }

    .badge-success { background: #D1FAE5; color: #059669; }
    .badge-warning { background: #FEF3C7; color: #D97706; }
    .badge-error { background: #FEE2E2; color: #DC2626; }
    .badge-info { background: #DBEAFE; color: #2563EB; }
    .badge-purple { background: #EDE9FE; color: #7C3AED; }

    /* PROGRESS BAR */
    .progress-bar {
      height: 8px;
      background: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      border-radius: 4px;
      transition: width 0.3s;
    }

    .progress-fill.green { background: var(--success); }
    .progress-fill.blue { background: var(--primary); }
    .progress-fill.orange { background: var(--warning); }
    .progress-fill.red { background: var(--error); }
    .progress-fill.purple { background: var(--purple); }

    /* RESULT CARDS */
    .result-card {
      background: var(--bg);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      border: 1px solid var(--border);
    }

    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .result-actions {
      display: flex;
      gap: 8px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    /* HEALTH SCORE */
    .health-score {
      background: linear-gradient(135deg, var(--bg), #e2e8f0);
      border-radius: var(--radius);
      padding: 25px;
      margin-bottom: 20px;
      border: 1px solid var(--border);
    }

    .health-score-value {
      font-size: 48px;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .health-score-bar {
      height: 12px;
      background: #e5e7eb;
      border-radius: 6px;
      overflow: hidden;
      margin: 15px 0;
    }

    .health-score-fill {
      height: 100%;
      border-radius: 6px;
      transition: width 0.5s;
    }

    /* KEYWORD CARD */
    .keyword-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 15px;
      margin-bottom: 12px;
      transition: all 0.2s;
    }

    .keyword-card:hover {
      border-color: var(--primary);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
    }

    .keyword-main {
      font-weight: 600;
      font-size: 15px;
      margin-bottom: 8px;
    }

    .keyword-stats {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      font-size: 13px;
      color: var(--text-soft);
    }

    .keyword-stat {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    /* CLUSTER TREE */
    .cluster-item {
      padding: 10px 15px;
      border-left: 3px solid var(--border);
      margin-left: 20px;
      margin-bottom: 5px;
      transition: all 0.2s;
    }

    .cluster-item:hover {
      border-left-color: var(--primary);
      background: var(--bg);
    }

    .cluster-item.pillar {
      margin-left: 0;
      border-left-width: 4px;
      font-weight: 600;
    }

    .cluster-item .status {
      font-size: 12px;
      margin-left: 10px;
    }

    /* CHARACTER COUNTER */
    .char-counter {
      font-size: 12px;
      color: var(--text-soft);
      margin-top: 5px;
    }

    .char-counter.warning { color: var(--warning); }
    .char-counter.error { color: var(--error); }

    /* TOAST */
    .toast-container {
      position: fixed;
      top: 80px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .toast {
      background: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 300px;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from { transform: translateX(400px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .toast-success { border-left: 4px solid var(--success); }
    .toast-error { border-left: 4px solid var(--error); }
    .toast-warning { border-left: 4px solid var(--warning); }
    .toast-info { border-left: 4px solid var(--primary); }

    /* LOADING */
    .loading {
      text-align: center;
      padding: 40px;
      color: var(--text-soft);
    }

    .spinner {
      border: 3px solid var(--border);
      border-top-color: var(--primary);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* MOBILE */
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        width: 280px;
      }
      .sidebar.open { transform: translateX(0); }
      .main { margin-left: 0; }
      .menu-toggle { display: block; }
      .content { padding: 15px; }
      .stats-grid { grid-template-columns: 1fr 1fr; }
      .keyword-stats { flex-direction: column; gap: 5px; }
    }

    .overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      z-index: 99;
    }
    .overlay.active { display: block; }

    /* CHAT */
    .chat-toggle {
      position: fixed;
      bottom: 25px;
      right: 25px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, #3b82f6, #8b5cf6);
      color: white;
      border: none;
      font-size: 28px;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(59,130,246,0.4);
      z-index: 200;
      transition: transform 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .chat-toggle:hover { transform: scale(1.1); }

    .chat-window {
      position: fixed;
      bottom: 100px;
      right: 25px;
      width: 380px;
      height: 500px;
      background: var(--card);
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      display: flex;
      flex-direction: column;
      z-index: 200;
      overflow: hidden;
    }

    .chat-window.hidden { display: none; }

    .chat-header {
      padding: 15px 20px;
      background: var(--primary);
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .chat-header h3 { font-size: 16px; }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 15px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .chat-msg {
      max-width: 85%;
      padding: 10px 14px;
      border-radius: 12px;
      font-size: 14px;
      line-height: 1.4;
    }

    .chat-msg.user {
      background: var(--primary);
      color: white;
      align-self: flex-end;
      border-bottom-right-radius: 4px;
    }

    .chat-msg.ai {
      background: var(--bg);
      align-self: flex-start;
      border-bottom-left-radius: 4px;
    }

    .chat-input-area {
      padding: 15px;
      border-top: 1px solid var(--border);
      display: flex;
      gap: 10px;
    }

    .chat-input {
      flex: 1;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 14px;
      outline: none;
    }

    .chat-input:focus { border-color: var(--primary); }

    .chat-send {
      padding: 12px 20px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 500;
    }

    @media (max-width: 768px) {
      .chat-window {
        width: calc(100% - 20px);
        height: 60vh;
        right: 10px;
        bottom: 90px;
      }
    }

    /* SCAN POPUP */
    .scan-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: var(--card);
      border-radius: 16px;
      padding: 25px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      z-index: 300;
      width: 90%;
      max-width: 400px;
    }

    .scan-popup.active { display: block; }

    .scan-popup h3 { margin-bottom: 15px; }

    .scan-popup .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
    }

    .upload-area {
      border: 2px dashed var(--border);
      border-radius: 12px;
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .upload-area:hover { border-color: var(--primary); background: rgba(59,130,246,0.05); }
    .upload-area .icon { font-size: 40px; margin-bottom: 10px; }
    .upload-area p { color: var(--text-soft); font-size: 14px; }

    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    
    .skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
      border-radius: var(--radius);
    }
    
    .fade-in {
      animation: fadeIn 0.2s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* MINI CHART */
    .mini-chart {
      display: flex;
      align-items: flex-end;
      gap: 3px;
      height: 40px;
    }

    .mini-chart-bar {
      width: 8px;
      background: var(--primary);
      border-radius: 2px;
      transition: height 0.3s;
    }

    /* QUICK ACTIONS */
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
    }

    .quick-action-btn {
      padding: 15px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
    }

    .quick-action-btn:hover {
      border-color: var(--primary);
      background: white;
    }

    .quick-action-btn .icon {
      font-size: 24px;
      margin-bottom: 8px;
    }

    .quick-action-btn .label {
      font-size: 13px;
      font-weight: 500;
    }

    /* OPPORTUNITY CARD */
    .opportunity-card {
      background: linear-gradient(135deg, #fef3c7, #fde68a);
      border: 1px solid #fcd34d;
      border-radius: var(--radius);
      padding: 15px;
      margin-bottom: 10px;
    }

    .opportunity-card .potential {
      color: #92400e;
      font-weight: 600;
    }

    /* AI RECOMMENDATION */
    .ai-recommendation {
      background: linear-gradient(135deg, #ede9fe, #ddd6fe);
      border: 1px solid #c4b5fd;
      border-radius: var(--radius);
      padding: 15px;
      margin-bottom: 15px;
    }

    .ai-recommendation .icon {
      font-size: 20px;
      margin-right: 10px;
    }

    /* SUBTABS */
    .subtabs {
      display: flex;
      gap: 5px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .subtab {
      padding: 8px 16px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 20px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s;
    }

    .subtab:hover { border-color: var(--primary); }
    .subtab.active { background: var(--primary); color: white; border-color: var(--primary); }

    /* FORM GROUP */
    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      font-size: 14px;
    }

    /* TOGGLE */
    .toggle-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .toggle-btn {
      padding: 8px 16px;
      border: 1px solid var(--border);
      background: white;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s;
    }

    .toggle-btn:hover { border-color: var(--primary); }
    .toggle-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

    /* GRID LAYOUTS */
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }

    @media (max-width: 768px) {
      .grid-2, .grid-3 { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="toast-container" id="toastContainer"></div>

  <aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <span class="logo-icon" id="logoIcon">ğŸ‰</span>
      <span class="logo-text" id="logoText">SuperParty</span>
    </div>
    <nav class="sidebar-nav" id="sidebarNav"></nav>
  </aside>

  <div class="overlay" id="overlay"></div>

  <main class="main">
    <header class="header">
      <button class="menu-toggle" id="menuToggle">â˜°</button>
      <h1 class="page-title" id="pageTitle">AcasÄƒ</h1>
      <div id="headerRight"></div>
    </header>
    <div class="content" id="content"></div>
  </main>

  <button class="chat-toggle" id="chatToggle">ğŸ¤–</button>

  <div class="scan-popup" id="scanPopup">
    <button class="close-btn" onclick="closeScanPopup()">âœ•</button>
    <h3 id="scanPopupTitle">ğŸ“· ScaneazÄƒ document</h3>
    <div class="upload-area" id="uploadArea">
      <div class="icon">ğŸ“¤</div>
      <p>Click sau trage fiÈ™ierul</p>
      <input type="file" id="fileInput" accept="image/*,.pdf" style="display:none;">
    </div>
    <div id="scanStatus" style="display:none;text-align:center;padding:20px;"></div>
  </div>

  <div class="chat-window hidden" id="chatWindow">
    <div class="chat-header">
      <div style="display:flex;align-items:center;gap:8px;">
        <span>ğŸ¤–</span>
        <h3>SuperParty AI</h3>
      </div>
    </div>
    <div class="chat-messages" id="chatMessages"></div>
    <div class="chat-input-area">
      <input type="text" class="chat-input" id="chatInput" placeholder="Scrie un mesaj...">
      <button class="chat-send" id="chatSend">Trimite</button>
    </div>
  </div>

  <script>
    // ===== CONFIG - MODIFICÄ‚ DOAR AICI! =====
    const BACKEND_URL = "https://script.google.com/macros/s/AKfycbwBzo1-F2DNxfIiSlcfrAgF-nUFyn2v9LbotEpTr-hnJhOlBzxZW2eV5okPEtOj-9iL/exec";
    
    // âš ï¸ SECURITY WARNING: Parolele sunt vizibile Ã®n source code!
    // Pentru producÈ›ie: mutÄƒ validarea pe backend sau foloseÈ™te token-based auth
    // SCHIMBÄ‚ ACESTE PAROLE ÃNAINTE DE DEPLOY!
    const GM_PASSWORD = "SPgm2024#Secure!XyZ";
    const ADMIN_PASSWORD = "SPadmin2024#Pro!ABC";

    // ===== STATE =====
    let currentMode = "standard";
    let editMode = false;
    let currentPage = null;
    let currentGMPage = null;
    let appData = { pagini: [], tabele: [], elemente: [], scanari: [], stiluri: {} };
    let currentScanType = null;
    let currentGenResults = { seo: [], ads: [] };
    
    // SEO/ADS DATA CACHE
    let seoData = {
      keywords: [],
      pages: [],
      clusters: [],
      rankings: [],
      backlinks: [],
      audit: null
    };
    
    let adsData = {
      campaigns: [],
      ads: [],
      keywords: [],
      performance: []
    };
    
    // USER SESSION
    let currentUser = null;
    let isLoggedIn = false;
    const savedUser = localStorage.getItem('superparty_user');
    if (savedUser) { try { currentUser = JSON.parse(savedUser); isLoggedIn = true; } catch(e) {} }
    
    function saveUserSession(user) { currentUser = user; isLoggedIn = true; localStorage.setItem('superparty_user', JSON.stringify(user)); }
    function clearUserSession() { currentUser = null; isLoggedIn = false; localStorage.removeItem('superparty_user'); }

    // CACHE
    const cache = {
      tables: {},
      cunostinte: null,
      deVerificat: null,
      reguli: null,
      conversatii: null
    };

    // ===== ELEMENTS =====
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("overlay");
    const menuToggle = document.getElementById("menuToggle");
    const sidebarNav = document.getElementById("sidebarNav");
    const pageTitle = document.getElementById("pageTitle");
    const content = document.getElementById("content");
    const chatToggle = document.getElementById("chatToggle");
    const chatWindow = document.getElementById("chatWindow");
    const chatMessages = document.getElementById("chatMessages");
    const chatInput = document.getElementById("chatInput");
    const chatSend = document.getElementById("chatSend");
    const scanPopup = document.getElementById("scanPopup");
    const uploadArea = document.getElementById("uploadArea");
    const fileInput = document.getElementById("fileInput");
    const scanStatus = document.getElementById("scanStatus");
    const toastContainer = document.getElementById("toastContainer");

    // ===== UTILITY FUNCTIONS =====
    function showToast(message, type = 'info', duration = 4000) {
      const toast = document.createElement('div');
      toast.className = `toast toast-${type}`;
      const icons = { success: 'âœ…', error: 'âŒ', warning: 'âš ï¸', info: 'â„¹ï¸' };
      toast.innerHTML = `<span style="font-size:20px;">${icons[type]}</span><span>${message}</span>`;
      toastContainer.appendChild(toast);
      setTimeout(() => {
        toast.style.animation = 'slideIn 0.3s ease-out reverse';
        setTimeout(() => toast.remove(), 300);
      }, duration);
    }

    function formatCost(cost) { return '$' + parseFloat(cost).toFixed(4); }

    function formatNumber(num) {
      if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
      if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
      return num.toString();
    }

    function getScoreColor(score) {
      if (score >= 80) return 'green';
      if (score >= 60) return 'orange';
      return 'red';
    }

    function getScoreBadge(score) {
      if (score >= 80) return '<span class="badge badge-success">' + score + '%</span>';
      if (score >= 60) return '<span class="badge badge-warning">' + score + '%</span>';
      return '<span class="badge badge-error">' + score + '%</span>';
    }

    // ===== EVENTS =====
    menuToggle.addEventListener("click", () => {
      sidebar.classList.toggle("open");
      overlay.classList.toggle("active");
    });

    overlay.addEventListener("click", () => {
      sidebar.classList.remove("open");
      overlay.classList.remove("active");
      closeScanPopup();
    });

    chatToggle.addEventListener("click", () => chatWindow.classList.toggle("hidden"));
    chatSend.addEventListener("click", handleChatSend);
    chatInput.addEventListener("keypress", (e) => { if (e.key === "Enter") handleChatSend(); });

    // ===== LOAD APP =====
    async function loadApp() {
      showWelcomePage();
      renderNav();
      
      try {
        const [appResponse, configResponse] = await Promise.all([
          fetch(BACKEND_URL + "?action=loadApp").catch(() => null),
          fetch(BACKEND_URL + "?action=loadPageConfig").catch(() => null)
        ]);
        
        if (appResponse) {
          const data = await appResponse.json();
          if (data.ok) appData = data.data;
        }
        
        if (configResponse) {
          const configData = await configResponse.json();
          if (configData.ok) {
            appData.filters = configData.data.filters || [];
            appData.formulas = configData.data.formulas || [];
            appData.progressBars = configData.data.progressBars || [];
            appData.tableSorts = configData.data.tableSorts || [];
            appData.pageStyles = configData.data.pageStyles || {};
          }
        }
        
        applyStyles();
        renderNav();
        
        if (appData.pagini.length > 0) {
          const firstPage = appData.pagini.find(p => p.vizibil && (p.mod === "normal" || p.mod === "all"));
          if (firstPage) navigateTo(firstPage);
        }
      } catch (e) {
        console.log("Background load error:", e);
      }
    }
    
    function showWelcomePage() {
      const userName = isLoggedIn && currentUser ? currentUser.name : '';
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#3b82f6,#8b5cf6);">
          <h2>ğŸ‰ Bine ai venit${userName ? ', ' + userName : ''}!</h2>
          <p>SuperParty - Sistemul tÄƒu de management</p>
        </div>
      `;
    }

    // ===== APPLY STYLES =====
    function applyStyles() {
      const s = appData.stiluri;
      if (s.primary?.color) {
        document.documentElement.style.setProperty('--primary', s.primary.color);
        document.documentElement.style.setProperty('--primary-dark', shadeColor(s.primary.color, -20));
      }
      if (s.sidebar?.background) document.documentElement.style.setProperty('--card', s.sidebar.background);
      if (s.text?.color) document.documentElement.style.setProperty('--text', s.text.color);
      if (s.background?.color) document.documentElement.style.setProperty('--bg', s.background.color);
      if (s.app?.font) document.body.style.fontFamily = s.app.font + ', sans-serif';
      if (s.app?.title) {
        document.getElementById("logoText").textContent = s.app.title;
        document.title = s.app.title;
      }
      if (s.app?.logo) document.getElementById("logoIcon").textContent = s.app.logo;
      if (s.chat?.button) document.getElementById("chatToggle").textContent = s.chat.button;
    }

    function shadeColor(color, percent) {
      const num = parseInt(color.replace("#", ""), 16);
      const amt = Math.round(2.55 * percent);
      const R = (num >> 16) + amt;
      const G = (num >> 8 & 0x00FF) + amt;
      const B = (num & 0x0000FF) + amt;
      return "#" + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 + (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 + (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1);
    }

    // ===== RENDER NAV =====
    function renderNav() {
      let html = '';
      
      // UTILIZATOR NORMAL LOGAT
      if (isLoggedIn && currentMode === "standard") {
        html += '<div class="nav-section"><div class="nav-section-title">Meniu</div>';
        html += `<div class="nav-item" data-page-id="home-user"><span class="icon">ğŸ </span><span>AcasÄƒ</span></div>`;
        html += `<div class="nav-item" data-page-id="events-user"><span class="icon">ğŸ‰</span><span>Evenimente</span></div>`;
        html += `<div class="nav-item" data-page-id="profile-user"><span class="icon">ğŸ‘¤</span><span>Profil</span></div>`;
        html += '</div>';
        html += '<div class="nav-section" style="margin-top:auto;border-top:1px solid var(--border);padding-top:15px;">';
        html += `<div class="nav-item" onclick="logoutUser()" style="color:#ef4444;"><span class="icon">ğŸšª</span><span>Deconectare</span></div>`;
        html += '</div>';
        sidebarNav.innerHTML = html;
        attachNavListeners();
        return;
      }
      
      // MOD STANDARD (nelogat)
      if (currentMode === "standard") {
        const normalPages = appData.pagini.filter(p => p.vizibil && (p.mod === "normal" || p.mod === "all"));
        if (normalPages.length > 0) {
          html += '<div class="nav-section"><div class="nav-section-title">Meniu</div>';
          normalPages.forEach(p => {
            html += `<div class="nav-item" data-page-id="${p.id}"><span class="icon">${p.icon || 'ğŸ“„'}</span><span>${p.nume}</span></div>`;
          });
          html += '</div>';
        }
        sidebarNav.innerHTML = html;
        attachNavListeners();
        return;
      }

      // MOD ADMIN
      if (currentMode === "admin") {
        const normalPages = appData.pagini.filter(p => p.vizibil && (p.mod === "normal" || p.mod === "all"));
        if (normalPages.length > 0) {
          html += '<div class="nav-section"><div class="nav-section-title">Meniu</div>';
          normalPages.forEach(p => {
            html += `<div class="nav-item" data-page-id="${p.id}"><span class="icon">${p.icon || 'ğŸ“„'}</span><span>${p.nume}</span></div>`;
          });
          html += '</div>';
        }
        
        const adminPages = appData.pagini.filter(p => p.vizibil && p.mod === "admin");
        if (adminPages.length > 0) {
          html += '<div class="nav-section"><div class="nav-section-title" style="color:#ef4444;">ğŸ”’ Mod Admin</div>';
          adminPages.forEach(p => {
            html += `<div class="nav-item" data-page-id="${p.id}"><span class="icon">${p.icon || 'ğŸ“„'}</span><span>${p.nume}</span></div>`;
          });
          html += '</div>';
        }
        
        html += '<div class="nav-section"><div class="nav-section-title">Utilizatori</div>';
        html += `<div class="nav-item" data-page-id="users-admin"><span class="icon">ğŸ‘¥</span><span>Gestionare Utilizatori</span></div>`;
        html += '</div>';
        
        sidebarNav.innerHTML = html;
        attachNavListeners();
        return;
      }

      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      // MOD GM - STRUCTURA NOUÄ‚
      // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      if (currentMode === "gm") {
        // Meniu normal
        const normalPages = appData.pagini.filter(p => p.vizibil && (p.mod === "normal" || p.mod === "all"));
        if (normalPages.length > 0) {
          html += '<div class="nav-section"><div class="nav-section-title">Meniu</div>';
          normalPages.forEach(p => {
            html += `<div class="nav-item" data-page-id="${p.id}"><span class="icon">${p.icon || 'ğŸ“„'}</span><span>${p.nume}</span></div>`;
          });
          html += '</div>';
        }
        
        // ğŸ® GM Core - PÄ‚STRAT EXACT
        html += '<div class="nav-section"><div class="nav-section-title" style="color:#8b5cf6;">ğŸ® GM Core</div>';
        html += `<div class="nav-item" data-page-id="creier-ai"><span class="icon">ğŸ§ </span><span>Creier AI</span></div>`;
        html += `<div class="nav-item" data-page-id="de-verificat"><span class="icon">âœ…</span><span>De verificat</span></div>`;
        html += `<div class="nav-item" data-page-id="reguli-fundamentale"><span class="icon">ğŸ”’</span><span>Reguli Fundamentale</span></div>`;
        html += `<div class="nav-item" data-page-id="conversatii"><span class="icon">ğŸ’¬</span><span>ConversaÈ›ii</span></div>`;
        html += '</div>';
        
        // ğŸ” SEO COMMAND CENTER - NOU
        html += '<div class="nav-section"><div class="nav-section-title" style="color:#10B981;">ğŸ” SEO Command Center</div>';
        html += `<div class="nav-item" data-page-id="seo-dashboard"><span class="icon">ğŸ“Š</span><span>SEO Dashboard</span></div>`;
        html += `<div class="nav-item" data-page-id="seo-keywords"><span class="icon">ğŸ¯</span><span>Keywords Central</span></div>`;
        html += `<div class="nav-item" data-page-id="seo-content"><span class="icon">ğŸ“</span><span>Content Hub</span></div>`;
        html += `<div class="nav-item" data-page-id="seo-technical"><span class="icon">âš¡</span><span>Technical SEO</span></div>`;
        html += `<div class="nav-item" data-page-id="seo-rankings"><span class="icon">ğŸ“ˆ</span><span>Rankings</span></div>`;
        html += `<div class="nav-item" data-page-id="seo-backlinks"><span class="icon">ğŸ”—</span><span>Backlinks</span></div>`;
        html += `<div class="nav-item" data-page-id="seo-ai-studio"><span class="icon">ğŸ¤–</span><span>SEO AI Studio</span></div>`;
        html += '</div>';
        
        // ğŸ“¢ ADS COMMAND CENTER - NOU
        html += '<div class="nav-section"><div class="nav-section-title" style="color:#F59E0B;">ğŸ“¢ Ads Command Center</div>';
        html += `<div class="nav-item" data-page-id="ads-dashboard"><span class="icon">ğŸ“Š</span><span>Ads Dashboard</span></div>`;
        html += `<div class="nav-item" data-page-id="ads-campaigns"><span class="icon">ğŸ¯</span><span>Campaigns</span></div>`;
        html += `<div class="nav-item" data-page-id="ads-keywords"><span class="icon">ğŸ”‘</span><span>Keywords & Targeting</span></div>`;
        html += `<div class="nav-item" data-page-id="ads-library"><span class="icon">ğŸ“</span><span>Ads Library</span></div>`;
        html += `<div class="nav-item" data-page-id="ads-budget"><span class="icon">ğŸ’°</span><span>Budget & Pacing</span></div>`;
        html += `<div class="nav-item" data-page-id="ads-ai-studio"><span class="icon">ğŸ¤–</span><span>Ads AI Studio</span></div>`;
        html += '</div>';
        
        // ğŸ“ˆ PERFORMANCE HUB - NOU
        html += '<div class="nav-section"><div class="nav-section-title" style="color:#3B82F6;">ğŸ“ˆ Performance Hub</div>';
        html += `<div class="nav-item" data-page-id="perf-unified"><span class="icon">ğŸ“Š</span><span>Unified Dashboard</span></div>`;
        html += `<div class="nav-item" data-page-id="perf-calendar"><span class="icon">ğŸ“…</span><span>Content Calendar</span></div>`;
        html += `<div class="nav-item" data-page-id="perf-goals"><span class="icon">ğŸ¯</span><span>Goals & KPIs</span></div>`;
        html += '</div>';
        
        // ğŸ’° Budget & AI - NOU
        html += '<div class="nav-section"><div class="nav-section-title" style="color:#10B981;">ğŸ’° Budget & AI</div>';
        html += `<div class="nav-item" data-page-id="budget-dashboard"><span class="icon">ğŸ’°</span><span>Budget Dashboard</span></div>`;
        html += `<div class="nav-item" data-page-id="budget-settings"><span class="icon">âš™ï¸</span><span>Settings</span></div>`;
        html += `<div class="nav-item" data-page-id="budget-history"><span class="icon">ğŸ“œ</span><span>Spend History</span></div>`;
        html += `<div class="nav-item" data-page-id="budget-errors"><span class="icon">âš ï¸</span><span>Errors</span></div>`;
        html += `<div class="nav-item" data-page-id="self-healing"><span class="icon">ğŸ”§</span><span>Self-Healing</span></div>`;
        html += '</div>';
        
        // ğŸ‘¥ Utilizatori - PÄ‚STRAT
        html += '<div class="nav-section"><div class="nav-section-title">Utilizatori</div>';
        html += `<div class="nav-item" data-page-id="users-gm"><span class="icon">ğŸ‘¥</span><span>Gestionare Utilizatori</span></div>`;
        html += '</div>';
        
        sidebarNav.innerHTML = html;
        attachNavListeners();
        return;
      }
    }
    
    function attachNavListeners() {
      document.querySelectorAll(".nav-item").forEach(item => {
        item.addEventListener("click", () => {
          const pageId = item.dataset.pageId;
          
          // User pages
          if (pageId === "home-user") showUserHome();
          else if (pageId === "events-user") showUserEvents();
          else if (pageId === "profile-user") showUserProfile();
          
          // GM Core pages - PÄ‚STRAT
          else if (pageId === "creier-ai") showCreierAI();
          else if (pageId === "de-verificat") showDeVerificat();
          else if (pageId === "reguli-fundamentale") showReguliFundamentale();
          else if (pageId === "conversatii") showConversatii();
          
          // SEO Command Center - NOU
          else if (pageId === "seo-dashboard") showSEODashboard();
          else if (pageId === "seo-keywords") showSEOKeywords();
          else if (pageId === "seo-content") showSEOContent();
          else if (pageId === "seo-technical") showSEOTechnical();
          else if (pageId === "seo-rankings") showSEORankings();
          else if (pageId === "seo-backlinks") showSEOBacklinks();
          else if (pageId === "seo-ai-studio") showSEOAIStudio();
          
          // Ads Command Center - NOU
          else if (pageId === "ads-dashboard") showAdsDashboard();
          else if (pageId === "ads-campaigns") showAdsCampaigns();
          else if (pageId === "ads-keywords") showAdsKeywords();
          else if (pageId === "ads-library") showAdsLibrary();
          else if (pageId === "ads-budget") showAdsBudget();
          else if (pageId === "ads-ai-studio") showAdsAIStudio();
          
          // Performance Hub - NOU
          else if (pageId === "perf-unified") showPerfUnified();
          else if (pageId === "perf-calendar") showPerfCalendar();
          else if (pageId === "perf-goals") showPerfGoals();
          
          // Budget & AI - NOU
          else if (pageId === "budget-dashboard") showBudgetDashboard();
          else if (pageId === "budget-settings") showBudgetSettings();
          else if (pageId === "budget-history") showBudgetHistory();
          else if (pageId === "budget-errors") showBudgetErrors();
          else if (pageId === "self-healing") showSelfHealing();
          
          // Users
          else if (pageId === "users-admin") showUsersAdmin();
          else if (pageId === "users-gm") showUsersGM();
          
          // Dynamic pages
          else {
            const page = appData.pagini.find(p => String(p.id) === pageId);
            if (page) navigateTo(page);
          }
          
          document.querySelectorAll(".nav-item").forEach(i => i.classList.remove("active"));
          item.classList.add("active");
          sidebar.classList.remove("open");
          overlay.classList.remove("active");
        });
      });
    }
    
    // ===== USER PAGES =====
    function showUserHome() {
      currentGMPage = "home-user"; currentPage = null;
      pageTitle.textContent = "AcasÄƒ";
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#3b82f6,#8b5cf6);">
          <h2>ğŸ‰ Bine ai venit, ${currentUser?.name || 'User'}!</h2>
          <p>SuperParty - Sistemul tÄƒu de management</p>
        </div>
        <div class="card fade-in">
          <div class="card-title">ğŸ“Š Statistici rapide</div>
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:15px;margin-top:15px;">
            <div style="background:#f0fdf4;padding:20px;border-radius:12px;text-align:center;">
              <div style="font-size:28px;font-weight:700;color:#22c55e;">12</div>
              <div style="font-size:12px;color:#6b7280;">Evenimente</div>
            </div>
            <div style="background:#eff6ff;padding:20px;border-radius:12px;text-align:center;">
              <div style="font-size:28px;font-weight:700;color:#3b82f6;">5</div>
              <div style="font-size:12px;color:#6b7280;">Luna aceasta</div>
            </div>
          </div>
        </div>
      `;
    }
    
    function showUserEvents() {
      currentGMPage = "events-user"; currentPage = null;
      pageTitle.textContent = "Evenimente";
      content.innerHTML = `
        <div class="card fade-in">
          <div class="card-title">ğŸ‰ Evenimentele tale</div>
          <p style="color:var(--text-soft);">Aici vor apÄƒrea evenimentele la care eÈ™ti alocat.</p>
          <div class="empty-state" style="margin-top:20px;">
            <div style="font-size:48px;margin-bottom:10px;">ğŸ“…</div>
            <div>Nu ai evenimente momentan</div>
          </div>
        </div>
      `;
    }
    
    function showUserProfile() {
      currentGMPage = "profile-user"; currentPage = null;
      pageTitle.textContent = "Profil";
      content.innerHTML = `
        <div class="card fade-in">
          <div class="card-title">ğŸ‘¤ Profilul tÄƒu</div>
          <div style="margin-top:20px;">
            <div style="display:flex;align-items:center;gap:20px;margin-bottom:20px;">
              <div style="width:80px;height:80px;background:linear-gradient(135deg,#3b82f6,#8b5cf6);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:32px;color:white;">
                ${(currentUser?.name || 'U')[0].toUpperCase()}
              </div>
              <div>
                <h3 style="margin:0;font-size:20px;">${currentUser?.name || 'User'}</h3>
                <p style="margin:5px 0 0;color:var(--text-soft);">${currentUser?.email || ''}</p>
                <span style="display:inline-block;margin-top:8px;padding:4px 12px;background:#ede9fe;color:#8b5cf6;border-radius:20px;font-size:12px;font-weight:600;">${currentUser?.role || 'Utilizator'}</span>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // ===== NAVIGATE (PÄ‚STRAT EXACT) =====
    function navigateTo(page) {
      currentPage = page;
      currentGMPage = null;
      pageTitle.textContent = page.nume;
      
      const pageTables = appData.tabele.filter(t => t.paginaId === page.id && t.vizibil !== false);
      const pageElements = (appData.elemente || []).filter(e => e.paginaId === page.id);
      const pageFilters = (appData.filters || []).filter(f => f.pageName === page.nume);
      const pageStyles = (appData.pageStyles || {})[page.nume] || {};
      
      let pageStyleCSS = '';
      if (pageStyles.background) pageStyleCSS += `background:${pageStyles.background};`;
      if (pageStyles.darkMode === 'true') pageStyleCSS += 'background:#1f2937;color:#f9fafb;';
      
      let html = `<div class="welcome-card fade-in" style="${pageStyleCSS}"><h2>${page.icon || ''} ${page.nume}</h2></div>`;
      
      if (pageFilters.length > 0) {
        html += '<div class="card fade-in"><div class="card-title">ğŸ” Filtre</div><div style="display:flex;flex-wrap:wrap;gap:10px;">';
        pageFilters.forEach(filter => {
          const options = filter.options ? filter.options.split(',') : [];
          html += `<div style="flex:1;min-width:150px;">
            <label style="font-size:12px;color:var(--text-soft);">${filter.filterName}</label>
            <select class="select" style="margin-top:4px;" onchange="applyFilter('${filter.filterBy}', this.value)">
              <option value="">Toate</option>
              ${options.map(opt => `<option value="${opt.trim()}">${opt.trim()}</option>`).join('')}
            </select>
          </div>`;
        });
        html += '</div></div>';
      }
      
      if (pageElements.length > 0) {
        html += '<div class="card fade-in"><div class="card-title">AcÈ›iuni</div><div>';
        pageElements.forEach(el => { html += renderElement(el); });
        html += '</div></div>';
      }
      
      if (pageTables.length === 0 && pageElements.length === 0) {
        html += '<div class="card fade-in"><div class="empty-state">PaginÄƒ goalÄƒ</div></div>';
      } else {
        pageTables.forEach(table => {
          const cachedData = cache.tables[table.numeTabel];
          if (cachedData) {
            html += `<div class="card fade-in" style="${pageStyleCSS}"><div class="card-title">${table.numeTabel}</div><div id="table-${table.numeTabel}">${renderTableHTML(cachedData)}</div></div>`;
          } else {
            html += `<div class="card fade-in" style="${pageStyleCSS}"><div class="card-title">${table.numeTabel}</div><div id="table-${table.numeTabel}"><div class="skeleton" style="height:100px;"></div></div></div>`;
          }
        });
      }
      
      content.innerHTML = html;
      pageTables.forEach(table => loadTableData(table));
    }
    
    function renderTableHTML(data) {
      if (!data || !data.rows || data.rows.length === 0) {
        return '<div class="empty-state">Nicio Ã®nregistrare</div>';
      }
      
      let html = '<table class="data-table"><thead><tr>';
      data.headers.forEach(h => { html += `<th>${h}</th>`; });
      html += '</tr></thead><tbody>';
      
      data.rows.forEach((row) => {
        html += '<tr>';
        row.forEach((cell, colIndex) => {
          const colName = data.headers[colIndex];
          if (colName === 'Status') {
            const statusColors = { 'confirmat': '#22c55e', 'Ã®n aÈ™teptare': '#f59e0b', 'anulat': '#ef4444' };
            const color = statusColors[cell?.toLowerCase()] || '#6b7280';
            html += `<td><span style="padding:4px 8px;border-radius:4px;background:${color}20;color:${color};font-size:12px;font-weight:600;">${cell || ''}</span></td>`;
          } else {
            html += `<td>${cell || ''}</td>`;
          }
        });
        html += '</tr>';
      });
      
      html += '</tbody></table>';
      return html;
    }
    
    let activeFilters = {};
    
    function applyFilter(filterBy, value) {
      if (value) activeFilters[filterBy] = value;
      else delete activeFilters[filterBy];
      if (currentPage) {
        const pageTables = appData.tabele.filter(t => t.paginaId === currentPage.id);
        pageTables.forEach(table => loadTableData(table, activeFilters));
      }
    }

    function renderElement(el) {
      switch(el.tip) {
        case 'buton': return `<button class="btn btn-primary" style="margin:5px;">${el.nume}</button>`;
        case 'dropdown':
          const opts = el.optiuni ? el.optiuni.split(',').map(o => `<option>${o.trim()}</option>`).join('') : '';
          return `<div style="margin:10px 0;"><label style="display:block;margin-bottom:5px;">${el.nume}</label><select class="select" style="width:200px;">${opts}</select></div>`;
        case 'checkbox': return `<label style="display:flex;align-items:center;gap:8px;margin:10px 0;cursor:pointer;"><input type="checkbox"><span>${el.nume}</span></label>`;
        default: return `<div style="margin:10px 0;"><label style="display:block;margin-bottom:5px;">${el.nume}</label><input type="text" class="input" style="width:100%;"></div>`;
      }
    }

    async function loadTableData(table) {
      try {
        const response = await fetch(BACKEND_URL + "?action=loadTable&table=" + table.numeTabel);
        const data = await response.json();
        const container = document.getElementById("table-" + table.numeTabel);
        if (data.ok) {
          cache.tables[table.numeTabel] = data.data;
          if (container) container.innerHTML = renderTableHTML(data.data);
        }
      } catch (e) {
        const container = document.getElementById("table-" + table.numeTabel);
        if (container) container.innerHTML = '<div class="empty-state">Eroare</div>';
      }
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // GM CORE PAGES - PÄ‚STRAT EXACT
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async function showCreierAI() {
      currentGMPage = "creier-ai"; currentPage = null;
      pageTitle.textContent = "Creier AI";
      if (cache.cunostinte) { renderCreierAI(cache.cunostinte); return; }
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ...</div></div>';
      try {
        const resp = await fetch(BACKEND_URL + "?action=loadCunostinte");
        const data = await resp.json();
        if (data.ok) { cache.cunostinte = data.data || []; renderCreierAI(cache.cunostinte); }
        else content.innerHTML = '<div class="card"><div class="empty-state">Nu s-au putut Ã®ncÄƒrca datele.</div></div>';
      } catch (e) { content.innerHTML = '<div class="card"><div class="empty-state">Eroare la Ã®ncÄƒrcare.</div></div>'; }
    }
    
    function renderCreierAI(data) {
      let html = '<div class="welcome-card fade-in" style="background:linear-gradient(135deg,#8b5cf6,#7c3aed);"><h2>ğŸ§  Creier AI</h2><p>Tot ce È™tie AI-ul</p></div>';
      if (data && data.length > 0) {
        const grouped = {};
        data.forEach(c => { const cat = c.categorie || 'general'; if (!grouped[cat]) grouped[cat] = []; grouped[cat].push(c); });
        for (const cat in grouped) {
          html += `<div class="card fade-in"><div class="card-title">${cat.toUpperCase()}</div>`;
          grouped[cat].forEach(c => { html += `<div style="padding:8px 0;border-bottom:1px solid var(--border);">â€¢ ${c.informatie}</div>`; });
          html += '</div>';
        }
      } else {
        html += '<div class="card fade-in"><div class="empty-state">AI-ul nu È™tie nimic Ã®ncÄƒ.<br><br>ÃnvaÈ›Äƒ-l din chat: <code>Ã®nvaÈ›Äƒ: [informaÈ›ie]</code></div></div>';
      }
      content.innerHTML = html;
    }

    async function showDeVerificat() {
      currentGMPage = "de-verificat"; currentPage = null;
      pageTitle.textContent = "De verificat";
      if (cache.deVerificat) { renderDeVerificat(cache.deVerificat); return; }
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ...</div></div>';
      try {
        const resp = await fetch(BACKEND_URL + "?action=loadDeVerificat");
        const data = await resp.json();
        if (data.ok) { cache.deVerificat = data.data || []; renderDeVerificat(cache.deVerificat); }
        else content.innerHTML = '<div class="card"><div class="empty-state">Nu s-au putut Ã®ncÄƒrca datele.</div></div>';
      } catch (e) { content.innerHTML = '<div class="card"><div class="empty-state">Eroare la Ã®ncÄƒrcare.</div></div>'; }
    }
    
    function renderDeVerificat(data) {
      let html = '<div class="welcome-card fade-in" style="background:linear-gradient(135deg,#f59e0b,#d97706);"><h2>âœ… De verificat</h2><p>CunoÈ™tinÈ›e de la utilizatori</p></div>';
      if (data && data.length > 0) {
        data.forEach(item => {
          html += `<div class="card fade-in">
            <div style="margin-bottom:10px;"><strong>Sursa:</strong> ${item.sursa}</div>
            <div style="margin-bottom:15px;">${item.informatie}</div>
            <div style="display:flex;gap:10px;">
              <button class="btn btn-primary" onclick="verificaCunostinta('${item.id}', 'aproba')">âœ… AprobÄƒ</button>
              <button class="btn btn-error" onclick="verificaCunostinta('${item.id}', 'respinge')">âŒ Respinge</button>
            </div>
          </div>`;
        });
      } else { html += '<div class="card fade-in"><div class="empty-state">Nimic de verificat! ğŸ‰</div></div>'; }
      content.innerHTML = html;
    }

    async function verificaCunostinta(id, actiune) {
      try {
        await fetch(BACKEND_URL + "?action=verificaCunostinta&id=" + encodeURIComponent(id) + "&actiune=" + encodeURIComponent(actiune));
        cache.deVerificat = null;
        showDeVerificat();
        showToast(actiune === 'aproba' ? 'âœ… Aprobat!' : 'âŒ Respins!', 'success');
      } catch (e) { showToast('Eroare', 'error'); }
    }

    async function showReguliFundamentale() {
      currentGMPage = "reguli"; currentPage = null;
      pageTitle.textContent = "Reguli Fundamentale";
      if (cache.reguli) { renderReguliFundamentale(cache.reguli); return; }
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ...</div></div>';
      try {
        const resp = await fetch(BACKEND_URL + "?action=loadReguli");
        const data = await resp.json();
        if (data.ok) { cache.reguli = data.data || []; renderReguliFundamentale(cache.reguli); }
        else content.innerHTML = '<div class="card"><div class="empty-state">Nu s-au putut Ã®ncÄƒrca datele.</div></div>';
      } catch (e) { content.innerHTML = '<div class="card"><div class="empty-state">Eroare la Ã®ncÄƒrcare.</div></div>'; }
    }
    
    function renderReguliFundamentale(data) {
      let html = '<div class="welcome-card fade-in" style="background:linear-gradient(135deg,#ef4444,#dc2626);"><h2>ğŸ”’ Reguli Fundamentale</h2><p>Reguli pe care AI-ul le respectÄƒ MEREU</p></div>';
      html += '<div class="card fade-in"><div class="card-title">AdaugÄƒ RegulÄƒ NouÄƒ</div>';
      html += '<div style="display:flex;gap:10px;"><input type="text" id="regulaNoua" class="input" style="flex:1;" placeholder="Ex: Ãntotdeauna salutÄƒ clientul cu BunÄƒ ziua!">';
      html += '<button class="btn btn-primary" onclick="adaugaRegula()">+ AdaugÄƒ</button></div></div>';
      
      const reguliActive = data ? data.filter(r => r.activ !== false) : [];
      const reguliInactive = data ? data.filter(r => r.activ === false) : [];
      
      html += '<div class="card fade-in"><div class="card-title" style="color:#22c55e;">âœ… Reguli Active (' + reguliActive.length + ')</div>';
      if (reguliActive.length > 0) {
        reguliActive.forEach((r, idx) => {
          html += `<div class="result-card" style="background:#f0fdf4;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div><strong style="color:#22c55e;">#${r.numar || idx + 1}</strong> ${(r.regula || '').substring(0, 100)}${(r.regula || '').length > 100 ? '...' : ''}</div>
              <div style="display:flex;gap:5px;">
                <button class="btn btn-secondary" style="padding:5px 10px;" onclick="toggleRegula('${r.id}', false)">â¸ï¸</button>
                <button class="btn btn-error" style="padding:5px 10px;" onclick="stergeRegula('${r.id}')">ğŸ—‘ï¸</button>
              </div>
            </div>
          </div>`;
        });
      } else { html += '<div class="empty-state">Nicio regulÄƒ activÄƒ.</div>'; }
      html += '</div>';
      
      if (reguliInactive.length > 0) {
        html += '<div class="card fade-in"><div class="card-title" style="color:#6b7280;">â¸ï¸ Reguli Inactive (' + reguliInactive.length + ')</div>';
        reguliInactive.forEach((r, idx) => {
          html += `<div class="result-card" style="opacity:0.6;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div><strong>#${r.numar || idx + 1}</strong> ${(r.regula || '').substring(0, 80)}...</div>
              <button class="btn btn-success" style="padding:5px 10px;" onclick="toggleRegula('${r.id}', true)">â–¶ï¸</button>
            </div>
          </div>`;
        });
        html += '</div>';
      }
      content.innerHTML = html;
    }

    async function adaugaRegula() {
      const input = document.getElementById("regulaNoua");
      const regula = input?.value.trim();
      if (!regula) { showToast('Scrie o regulÄƒ!', 'warning'); return; }
      try {
        await fetch(BACKEND_URL + "?action=adaugaRegula&regula=" + encodeURIComponent(regula));
        cache.reguli = null;
        input.value = "";
        showReguliFundamentale();
        showToast('âœ… RegulÄƒ adÄƒugatÄƒ!', 'success');
      } catch (e) { showToast('Eroare', 'error'); }
    }

    async function toggleRegula(id, activ) {
      try {
        await fetch(BACKEND_URL + "?action=toggleRegula&id=" + encodeURIComponent(id) + "&activ=" + activ);
        cache.reguli = null;
        showReguliFundamentale();
      } catch (e) { showToast('Eroare', 'error'); }
    }

    async function stergeRegula(id) {
      if (!confirm("Sigur È™tergi aceastÄƒ regulÄƒ?")) return;
      try {
        await fetch(BACKEND_URL + "?action=stergeRegula&id=" + encodeURIComponent(id));
        cache.reguli = null;
        showReguliFundamentale();
        showToast('RegulÄƒ È™tearsÄƒ', 'success');
      } catch (e) { showToast('Eroare', 'error'); }
    }

    async function showConversatii() {
      currentGMPage = "conversatii"; currentPage = null;
      pageTitle.textContent = "ConversaÈ›ii";
      if (cache.conversatii) { renderConversatii(cache.conversatii); return; }
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ...</div></div>';
      try {
        const resp = await fetch(BACKEND_URL + "?action=loadConversatii");
        const data = await resp.json();
        if (data.ok) { cache.conversatii = data.data || []; renderConversatii(cache.conversatii); }
        else content.innerHTML = '<div class="card"><div class="empty-state">Nu s-au putut Ã®ncÄƒrca datele.</div></div>';
      } catch (e) { content.innerHTML = '<div class="card"><div class="empty-state">Eroare la Ã®ncÄƒrcare.</div></div>'; }
    }
    
    function renderConversatii(data) {
      let html = '<div class="welcome-card fade-in" style="background:linear-gradient(135deg,#3b82f6,#2563eb);"><h2>ğŸ’¬ ConversaÈ›ii</h2><p>Tot ce a Ã®ntrebat oricine</p></div>';
      if (data && data.length > 0) {
        data.forEach((c, idx) => {
          const statusIcon = c.status === 'ok' ? 'âœ…' : c.status === 'corectat' ? 'ğŸ“' : 'â³';
          html += `<div class="card fade-in">
            <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
              <strong>#${idx + 1}</strong>
              <span style="color:var(--text-soft);font-size:12px;">${statusIcon} ${c.user || 'Anonim'}</span>
            </div>
            <div style="margin-bottom:8px;"><strong>User:</strong> "${c.mesaj}"</div>
            <div style="color:var(--text-soft);"><strong>AI:</strong> "${(c.raspuns || '').substring(0, 150)}..."</div>
            <div style="display:flex;gap:10px;margin-top:12px;">
              ${c.status !== 'ok' ? `<button class="btn btn-success" style="padding:6px 12px;" onclick="marcheazaOK('${c.id}')">âœ… OK</button>` : ''}
              <button class="btn btn-warning" style="padding:6px 12px;" onclick="corecteazaConversatie('${c.id}', '${(c.mesaj || '').replace(/'/g, "\\'")}')">âœï¸ CorecteazÄƒ</button>
            </div>
          </div>`;
        });
      } else { html += '<div class="card fade-in"><div class="empty-state">Nicio conversaÈ›ie Ã®ncÄƒ.</div></div>'; }
      content.innerHTML = html;
    }

    async function marcheazaOK(id) {
      try {
        await fetch(BACKEND_URL + "?action=marcheazaOK&id=" + encodeURIComponent(id));
        cache.conversatii = null;
        showConversatii();
      } catch (e) { showToast('Eroare', 'error'); }
    }

    async function corecteazaConversatie(id, mesaj) {
      const corectie = prompt("Cum trebuia sÄƒ rÄƒspundÄƒ AI-ul la:\n\"" + mesaj + "\"");
      if (!corectie) return;
      try {
        await fetch(BACKEND_URL + "?action=corecteazaConversatie&id=" + encodeURIComponent(id) + "&corectie=" + encodeURIComponent(corectie));
        cache.conversatii = null;
        showConversatii();
        showToast('âœ… AI-ul a Ã®nvÄƒÈ›at!', 'success');
      } catch (e) { showToast('Eroare', 'error'); }
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SEO COMMAND CENTER - NOU
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    function showSEODashboard() {
      currentGMPage = "seo-dashboard"; currentPage = null;
      pageTitle.textContent = "SEO Dashboard";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#10B981,#059669);">
          <h2>ğŸ” SEO Command Center</h2>
          <p>Overview complet al performanÈ›ei SEO</p>
        </div>
        
        <!-- Health Score -->
        <div class="health-score fade-in">
          <div style="display:flex;justify-content:space-between;align-items:center;">
            <div>
              <div style="font-size:14px;color:var(--text-soft);margin-bottom:5px;">SEO HEALTH SCORE</div>
              <div class="health-score-value" style="color:#10B981;">78<span style="font-size:24px;">/100</span></div>
              <div style="color:var(--text-soft);">"Bine, dar poate mai bine" ğŸ’ª</div>
            </div>
            <div style="text-align:right;">
              <button class="btn btn-success" onclick="runSEOAudit()">ğŸ”„ Run Full Audit</button>
            </div>
          </div>
          <div class="health-score-bar">
            <div class="health-score-fill" style="width:78%;background:linear-gradient(90deg,#10B981,#34D399);"></div>
          </div>
          <div style="display:flex;justify-content:space-between;font-size:13px;margin-top:10px;">
            <span>Technical: <strong style="color:#10B981;">85</strong></span>
            <span>Content: <strong style="color:#F59E0B;">72</strong></span>
            <span>Authority: <strong style="color:#F59E0B;">65</strong></span>
          </div>
        </div>
        
        <!-- Stats Grid -->
        <div class="stats-grid fade-in">
          <div class="stat-card green">
            <div class="stat-value">1,234</div>
            <div class="stat-label">ğŸ“ˆ Clicks (GSC)</div>
            <div class="stat-change">+12% vs luna trecutÄƒ</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">45.2K</div>
            <div class="stat-label">ğŸ‘ï¸ Impressions</div>
            <div class="stat-change">+8% vs luna trecutÄƒ</div>
          </div>
          <div class="stat-card purple">
            <div class="stat-value">4.2</div>
            <div class="stat-label">ğŸ“ Avg Position</div>
            <div class="stat-change">-0.3 (improved!)</div>
          </div>
          <div class="stat-card orange">
            <div class="stat-value">85</div>
            <div class="stat-label">âš¡ PageSpeed</div>
            <div class="stat-change">Mobile score</div>
          </div>
        </div>
        
        <!-- Opportunities -->
        <div class="card fade-in">
          <div class="card-title">
            <span>ğŸ¯ Top Opportunities</span>
            <button class="btn btn-secondary" onclick="showSEOKeywords()">Vezi toate â†’</button>
          </div>
          <div class="opportunity-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <strong>animatori petreceri sector 3</strong>
                <div style="font-size:13px;color:var(--text-soft);margin-top:5px;">Pos: 8.2 â”‚ Impr: 890 â”‚ CTR: 2.1%</div>
              </div>
              <div class="potential">+120 clicks potential</div>
            </div>
            <div class="result-actions">
              <button class="btn btn-primary" onclick="showSEOAIStudio()">ğŸ“ Generate Page</button>
              <button class="btn btn-secondary">ğŸ“Š Details</button>
            </div>
          </div>
          <div class="opportunity-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <strong>baloane heliu bucuresti</strong>
                <div style="font-size:13px;color:var(--text-soft);margin-top:5px;">Pos: 6.5 â”‚ Impr: 650 â”‚ CTR: 3.2%</div>
              </div>
              <div class="potential">+85 clicks potential</div>
            </div>
            <div class="result-actions">
              <button class="btn btn-primary" onclick="showSEOAIStudio()">ğŸ“ Optimize</button>
              <button class="btn btn-secondary">ğŸ“Š Details</button>
            </div>
          </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="card fade-in">
          <div class="card-title">âš¡ Quick Actions</div>
          <div class="quick-actions">
            <div class="quick-action-btn" onclick="showSEOAIStudio()">
              <div class="icon">âœ¨</div>
              <div class="label">Generate Content</div>
            </div>
            <div class="quick-action-btn" onclick="runSEOAudit()">
              <div class="icon">ğŸ”</div>
              <div class="label">Run Audit</div>
            </div>
            <div class="quick-action-btn" onclick="showSEORankings()">
              <div class="icon">ğŸ“ˆ</div>
              <div class="label">Check Rankings</div>
            </div>
            <div class="quick-action-btn" onclick="exportSEOReport()">
              <div class="icon">ğŸ“„</div>
              <div class="label">Export Report</div>
            </div>
          </div>
        </div>
      `;
    }
    
    function runSEOAudit() {
      showToast('ğŸ”„ Running full SEO audit...', 'info');
      setTimeout(() => showToast('âœ… Audit complete! Score: 78/100', 'success'), 2000);
    }
    
    function exportSEOReport() {
      showToast('ğŸ“„ Generating PDF report...', 'info');
      setTimeout(() => showToast('âœ… Report ready for download!', 'success'), 1500);
    }

    function showSEOKeywords() {
      currentGMPage = "seo-keywords"; currentPage = null;
      pageTitle.textContent = "Keywords Central";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#10B981,#059669);">
          <h2>ğŸ¯ Keywords Central</h2>
          <p>Track, analyze È™i optimize keywords</p>
        </div>
        
        <!-- Subtabs -->
        <div class="subtabs fade-in">
          <div class="subtab active" onclick="filterKeywords('all')">All Keywords</div>
          <div class="subtab" onclick="filterKeywords('tracked')">ğŸ“ Tracked</div>
          <div class="subtab" onclick="filterKeywords('opportunities')">ğŸ¯ Opportunities</div>
          <div class="subtab" onclick="filterKeywords('gaps')">ğŸ” Gaps</div>
        </div>
        
        <!-- Add Keyword -->
        <div class="card fade-in">
          <div style="display:flex;gap:10px;">
            <input type="text" class="input" id="newKeyword" placeholder="Add new keyword to track..." style="flex:1;">
            <button class="btn btn-success" onclick="addKeyword()">+ Add</button>
          </div>
        </div>
        
        <!-- Keywords List -->
        <div id="keywordsList">
          ${renderKeywordCard('animatori petreceri copii bucuresti', 3, '+2', '2.4K', 320, '/animatori-petreceri-copii')}
          ${renderKeywordCard('baloane cu heliu bucuresti', 7, '-1', '1.8K', 89, '/baloane-heliu')}
          ${renderKeywordCard('arcade petreceri copii', 11, '+3', '1.2K', 45, '/arcade-petreceri')}
          ${renderKeywordCard('animatori frozen bucuresti', 5, '0', '890', 78, '/animatori-frozen')}
          ${renderKeywordCard('petreceri tematice copii', 15, 'NEW', '650', 0, null)}
        </div>
        
        <!-- Keyword Gaps -->
        <div class="card fade-in">
          <div class="card-title">ğŸ” Keyword Gaps (Competitors rank, you don't)</div>
          <table class="data-table">
            <thead>
              <tr><th>Keyword</th><th>Competitor Pos</th><th>Volume</th><th>Difficulty</th><th>Action</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>petreceri tematice sector 1</strong></td>
                <td><span class="badge badge-success">#4</span></td>
                <td>480</td>
                <td><span class="badge badge-warning">Medium</span></td>
                <td><button class="btn btn-primary" style="padding:5px 10px;" onclick="showSEOAIStudio()">ğŸ¤– Generate</button></td>
              </tr>
              <tr>
                <td><strong>animatori marvel bucuresti</strong></td>
                <td><span class="badge badge-success">#6</span></td>
                <td>320</td>
                <td><span class="badge badge-success">Low</span></td>
                <td><button class="btn btn-primary" style="padding:5px 10px;" onclick="showSEOAIStudio()">ğŸ¤– Generate</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }
    
    function renderKeywordCard(keyword, position, change, volume, traffic, page) {
      const posColor = position <= 3 ? '#10B981' : position <= 10 ? '#F59E0B' : '#EF4444';
      const changeColor = change.includes('+') ? '#10B981' : change.includes('-') ? '#EF4444' : '#6B7280';
      return `
        <div class="keyword-card fade-in">
          <div class="keyword-main">${keyword}</div>
          <div class="keyword-stats">
            <div class="keyword-stat">ğŸ“ <strong style="color:${posColor};">#${position}</strong></div>
            <div class="keyword-stat">Î” <strong style="color:${changeColor};">${change}</strong></div>
            <div class="keyword-stat">ğŸ” ${volume}</div>
            <div class="keyword-stat">ğŸ‘¥ ${traffic} visits</div>
            ${page ? `<div class="keyword-stat">ğŸ“„ <a href="#" style="color:var(--primary);">${page}</a></div>` : '<div class="keyword-stat" style="color:#F59E0B;">âš ï¸ No page</div>'}
          </div>
          <div class="result-actions">
            <button class="btn btn-secondary" style="padding:5px 10px;">ğŸ“ˆ History</button>
            ${page ? '<button class="btn btn-secondary" style="padding:5px 10px;">âœï¸ Edit Page</button>' : '<button class="btn btn-primary" style="padding:5px 10px;">ğŸ¤– Create Page</button>'}
            <button class="btn btn-secondary" style="padding:5px 10px;">ğŸ¯ Optimize</button>
          </div>
        </div>
      `;
    }
    
    function filterKeywords(filter) {
      document.querySelectorAll('.subtab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      showToast('Filtered: ' + filter, 'info');
    }
    
    function addKeyword() {
      const input = document.getElementById('newKeyword');
      if (input.value.trim()) {
        showToast('âœ… Keyword added to tracking!', 'success');
        input.value = '';
      }
    }

    function showSEOContent() {
      currentGMPage = "seo-content"; currentPage = null;
      pageTitle.textContent = "Content Hub";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#10B981,#059669);">
          <h2>ğŸ“ Content Hub</h2>
          <p>Manage pages, clusters È™i content calendar</p>
        </div>
        
        <!-- Subtabs -->
        <div class="subtabs fade-in">
          <div class="subtab active" onclick="showContentTab('pages')">ğŸ“„ All Pages</div>
          <div class="subtab" onclick="showContentTab('clusters')">ğŸ¯ Clusters</div>
          <div class="subtab" onclick="showContentTab('calendar')">ğŸ“… Calendar</div>
          <div class="subtab" onclick="showContentTab('drafts')">âœï¸ Drafts</div>
        </div>
        
        <!-- Clusters -->
        <div class="card fade-in">
          <div class="card-title">
            <span>ğŸ¯ Content Clusters</span>
            <button class="btn btn-success" onclick="showSEOAIStudio()">+ New Cluster</button>
          </div>
          
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;align-items:center;padding:15px;background:var(--bg);border-radius:8px;margin-bottom:10px;">
              <div>
                <strong>ğŸˆ ANIMATORI</strong>
                <span class="badge badge-success" style="margin-left:10px;">Coverage: 65%</span>
              </div>
              <button class="btn btn-primary" style="padding:5px 10px;">ğŸ¤– Generate Missing</button>
            </div>
            <div class="cluster-item pillar" style="border-left-color:#10B981;">
              ğŸ“„ /animatori-petreceri-copii <span class="badge badge-success">âœ… Live</span>
            </div>
            <div class="cluster-item" style="border-left-color:#10B981;">
              ğŸ“„ /animatori-sector-1 <span class="badge badge-success">âœ… Live</span>
            </div>
            <div class="cluster-item" style="border-left-color:#10B981;">
              ğŸ“„ /animatori-sector-2 <span class="badge badge-success">âœ… Live</span>
            </div>
            <div class="cluster-item" style="border-left-color:#F59E0B;">
              ğŸ“ /animatori-sector-3 <span class="badge badge-warning">ğŸ“ Draft</span>
            </div>
            <div class="cluster-item" style="border-left-color:#6B7280;">
              â³ /animatori-sector-4 <span class="badge" style="background:#f3f4f6;color:#6b7280;">â³ Planned</span>
            </div>
            <div class="cluster-item" style="border-left-color:#6B7280;">
              â³ /animatori-sector-5 <span class="badge" style="background:#f3f4f6;color:#6b7280;">â³ Planned</span>
            </div>
          </div>
          
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;align-items:center;padding:15px;background:var(--bg);border-radius:8px;margin-bottom:10px;">
              <div>
                <strong>ğŸª ARCADE</strong>
                <span class="badge badge-warning" style="margin-left:10px;">Coverage: 40%</span>
              </div>
              <button class="btn btn-primary" style="padding:5px 10px;">ğŸ¤– Generate Missing</button>
            </div>
            <div class="cluster-item pillar" style="border-left-color:#10B981;">
              ğŸ“„ /arcade-petreceri <span class="badge badge-success">âœ… Live</span>
            </div>
            <div class="cluster-item" style="border-left-color:#F59E0B;">
              ğŸ“ /arcade-bucuresti <span class="badge badge-warning">ğŸ“ Draft</span>
            </div>
          </div>
        </div>
        
        <!-- Content Calendar -->
        <div class="card fade-in">
          <div class="card-title">ğŸ“… Content Calendar (This Week)</div>
          <table class="data-table">
            <thead>
              <tr><th>Day</th><th>Content</th><th>Status</th><th>Action</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Luni</strong></td>
                <td>ğŸ“ /animatori-sector-3</td>
                <td><span class="badge badge-warning">In Progress</span></td>
                <td><button class="btn btn-secondary" style="padding:4px 8px;">Edit</button></td>
              </tr>
              <tr>
                <td><strong>Miercuri</strong></td>
                <td>ğŸ“ /arcade-bucuresti</td>
                <td><span class="badge" style="background:#f3f4f6;color:#6b7280;">Planned</span></td>
                <td><button class="btn btn-primary" style="padding:4px 8px;">Generate</button></td>
              </tr>
              <tr>
                <td><strong>Vineri</strong></td>
                <td>ğŸ“Š Review & Optimize</td>
                <td><span class="badge badge-info">Weekly Task</span></td>
                <td><button class="btn btn-secondary" style="padding:4px 8px;">Start</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }

    function showSEOTechnical() {
      currentGMPage = "seo-technical"; currentPage = null;
      pageTitle.textContent = "Technical SEO";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#10B981,#059669);">
          <h2>âš¡ Technical SEO</h2>
          <p>PageSpeed, Core Web Vitals, Technical Issues</p>
        </div>
        
        <!-- PageSpeed Scores -->
        <div class="stats-grid fade-in">
          <div class="stat-card green">
            <div class="stat-value">85</div>
            <div class="stat-label">ğŸ“± Mobile Score</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">92</div>
            <div class="stat-label">ğŸ–¥ï¸ Desktop Score</div>
          </div>
          <div class="stat-card purple">
            <div class="stat-value">2.1s</div>
            <div class="stat-label">âš¡ LCP</div>
          </div>
          <div class="stat-card orange">
            <div class="stat-value">0.12</div>
            <div class="stat-label">ğŸ“Š CLS</div>
          </div>
        </div>
        
        <!-- Core Web Vitals -->
        <div class="card fade-in">
          <div class="card-title">ğŸ¯ Core Web Vitals</div>
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span>LCP (Largest Contentful Paint)</span>
              <strong style="color:#10B981;">2.1s âœ… Good</strong>
            </div>
            <div class="progress-bar"><div class="progress-fill green" style="width:85%;"></div></div>
          </div>
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span>FID (First Input Delay)</span>
              <strong style="color:#10B981;">45ms âœ… Good</strong>
            </div>
            <div class="progress-bar"><div class="progress-fill green" style="width:92%;"></div></div>
          </div>
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span>CLS (Cumulative Layout Shift)</span>
              <strong style="color:#F59E0B;">0.12 âš ï¸ Needs Improvement</strong>
            </div>
            <div class="progress-bar"><div class="progress-fill orange" style="width:65%;"></div></div>
          </div>
        </div>
        
        <!-- Technical Issues -->
        <div class="card fade-in">
          <div class="card-title">âš ï¸ Technical Issues (3 found)</div>
          <div class="result-card" style="border-left:4px solid #EF4444;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <strong style="color:#EF4444;">âŒ Missing meta descriptions</strong>
                <div style="font-size:13px;color:var(--text-soft);margin-top:5px;">3 pages without meta description</div>
              </div>
              <button class="btn btn-primary" style="padding:5px 10px;">Fix Now</button>
            </div>
          </div>
          <div class="result-card" style="border-left:4px solid #F59E0B;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <strong style="color:#F59E0B;">âš ï¸ Images without alt text</strong>
                <div style="font-size:13px;color:var(--text-soft);margin-top:5px;">12 images need alt attributes</div>
              </div>
              <button class="btn btn-secondary" style="padding:5px 10px;">View List</button>
            </div>
          </div>
          <div class="result-card" style="border-left:4px solid #F59E0B;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <strong style="color:#F59E0B;">âš ï¸ CLS issues on mobile</strong>
                <div style="font-size:13px;color:var(--text-soft);margin-top:5px;">Layout shift detected on homepage</div>
              </div>
              <button class="btn btn-secondary" style="padding:5px 10px;">Details</button>
            </div>
          </div>
        </div>
      `;
    }

    function showSEORankings() {
      currentGMPage = "seo-rankings"; currentPage = null;
      pageTitle.textContent = "Rankings";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#10B981,#059669);">
          <h2>ğŸ“ˆ Rankings</h2>
          <p>Position tracking È™i competitor analysis</p>
        </div>
        
        <!-- Summary -->
        <div class="stats-grid fade-in">
          <div class="stat-card green">
            <div class="stat-value">12</div>
            <div class="stat-label">ğŸ† Top 3</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">28</div>
            <div class="stat-label">ğŸ“ Top 10</div>
          </div>
          <div class="stat-card purple">
            <div class="stat-value">+5</div>
            <div class="stat-label">ğŸ“ˆ Improved</div>
          </div>
          <div class="stat-card red">
            <div class="stat-value">2</div>
            <div class="stat-label">ğŸ“‰ Dropped</div>
          </div>
        </div>
        
        <!-- Rankings Table -->
        <div class="card fade-in">
          <div class="card-title">ğŸ“Š Position Changes (Last 7 Days)</div>
          <table class="data-table">
            <thead>
              <tr><th>Keyword</th><th>Position</th><th>Change</th><th>Page</th><th>Competitor</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>animatori petreceri copii bucuresti</strong></td>
                <td><span style="font-size:20px;">ğŸ¥‰</span> #3</td>
                <td><span style="color:#10B981;font-weight:600;">â†‘ +2</span></td>
                <td>/animatori-petreceri-copii</td>
                <td>animatori.ro #1</td>
              </tr>
              <tr>
                <td><strong>baloane heliu bucuresti</strong></td>
                <td>#7</td>
                <td><span style="color:#EF4444;font-weight:600;">â†“ -1</span></td>
                <td>/baloane-heliu</td>
                <td>baloane.ro #2</td>
              </tr>
              <tr>
                <td><strong>arcade petreceri copii</strong></td>
                <td>#5</td>
                <td><span style="color:#10B981;font-weight:600;">â†‘ +3</span></td>
                <td>/arcade-petreceri</td>
                <td>arcade.ro #1</td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <!-- Competitor Comparison -->
        <div class="card fade-in">
          <div class="card-title">ğŸ†š vs Competitors</div>
          <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:15px;text-align:center;">
            <div style="padding:20px;background:var(--bg);border-radius:8px;">
              <div style="font-size:24px;font-weight:700;color:#10B981;">SuperParty</div>
              <div style="font-size:32px;margin:10px 0;">28</div>
              <div style="font-size:13px;color:var(--text-soft);">keywords in top 10</div>
            </div>
            <div style="padding:20px;background:var(--bg);border-radius:8px;">
              <div style="font-size:24px;font-weight:700;color:#6B7280;">animatori.ro</div>
              <div style="font-size:32px;margin:10px 0;">35</div>
              <div style="font-size:13px;color:var(--text-soft);">keywords in top 10</div>
            </div>
            <div style="padding:20px;background:var(--bg);border-radius:8px;">
              <div style="font-size:24px;font-weight:700;color:#6B7280;">petreceri.ro</div>
              <div style="font-size:32px;margin:10px 0;">22</div>
              <div style="font-size:13px;color:var(--text-soft);">keywords in top 10</div>
            </div>
          </div>
        </div>
      `;
    }

    function showSEOBacklinks() {
      currentGMPage = "seo-backlinks"; currentPage = null;
      pageTitle.textContent = "Backlinks";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#10B981,#059669);">
          <h2>ğŸ”— Backlinks</h2>
          <p>Domain authority È™i link profile</p>
        </div>
        
        <!-- Stats -->
        <div class="stats-grid fade-in">
          <div class="stat-card purple">
            <div class="stat-value">32</div>
            <div class="stat-label">ğŸ¯ Domain Rating</div>
          </div>
          <div class="stat-card green">
            <div class="stat-value">156</div>
            <div class="stat-label">ğŸ”— Total Backlinks</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">48</div>
            <div class="stat-label">ğŸŒ Referring Domains</div>
          </div>
          <div class="stat-card orange">
            <div class="stat-value">+5</div>
            <div class="stat-label">ğŸ“ˆ New (30 days)</div>
          </div>
        </div>
        
        <!-- Recent Backlinks -->
        <div class="card fade-in">
          <div class="card-title">ğŸ†• Recent Backlinks</div>
          <table class="data-table">
            <thead>
              <tr><th>Source</th><th>DR</th><th>Target Page</th><th>Type</th><th>Date</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><a href="#" style="color:var(--primary);">blog-petreceri.ro</a></td>
                <td><span class="badge badge-success">45</span></td>
                <td>/animatori-petreceri-copii</td>
                <td>DoFollow</td>
                <td>2 days ago</td>
              </tr>
              <tr>
                <td><a href="#" style="color:var(--primary);">mamici-bucuresti.ro</a></td>
                <td><span class="badge badge-warning">28</span></td>
                <td>/arcade-petreceri</td>
                <td>DoFollow</td>
                <td>5 days ago</td>
              </tr>
              <tr>
                <td><a href="#" style="color:var(--primary);">evenimente-copii.ro</a></td>
                <td><span class="badge badge-success">52</span></td>
                <td>/baloane-heliu</td>
                <td>NoFollow</td>
                <td>1 week ago</td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }

    function showSEOAIStudio() {
      currentGMPage = "seo-ai-studio"; currentPage = null;
      pageTitle.textContent = "SEO AI Studio";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#10B981,#059669);">
          <h2>ğŸ¤– SEO AI Studio</h2>
          <p>Generate, Train È™i Optimize cu AI</p>
        </div>
        
        <!-- Tabs -->
        <div class="tabs fade-in">
          <div class="tab active" onclick="switchSEOAITab('generate')">âœ¨ Generate</div>
          <div class="tab" onclick="switchSEOAITab('train')">ğŸ“š Train AI</div>
          <div class="tab" onclick="switchSEOAITab('coaching')">ğŸ“ Coaching</div>
          <div class="tab" onclick="switchSEOAITab('history')">ğŸ“œ History</div>
        </div>
        
        <!-- Generate Tab -->
        <div id="seo-ai-content">
          <div class="card fade-in">
            <div class="card-title">âœ¨ Generate New Content</div>
            
            <div class="form-group">
              <label>What do you want to create?</label>
              <div class="toggle-group">
                <div class="toggle-btn active">ğŸ“„ Full SEO Page</div>
                <div class="toggle-btn">ğŸ“ Meta Tags Only</div>
                <div class="toggle-btn">ğŸ¯ Content Brief</div>
                <div class="toggle-btn">ğŸ”„ Optimize Existing</div>
              </div>
            </div>
            
            <div class="form-group">
              <label>Brief:</label>
              <textarea class="textarea" id="seoBrief" placeholder="Exemplu: GenereazÄƒ paginÄƒ SEO pentru animatori petreceri copii Ã®n Sector 3 BucureÈ™ti, focus pe personaje Disney È™i Marvel, preÈ› competitiv..."></textarea>
            </div>
            
            <div class="grid-2">
              <div class="form-group">
                <label>AI Model:</label>
                <select class="select">
                  <option>Claude (Recommended)</option>
                  <option>GPT-4</option>
                  <option>Gemini</option>
                </select>
              </div>
              <div class="form-group">
                <label>Content Length:</label>
                <select class="select">
                  <option>800-1000 words</option>
                  <option selected>1000-1500 words</option>
                  <option>1500-2000 words</option>
                </select>
              </div>
            </div>
            
            <button class="btn btn-success" style="width:100%;padding:15px;font-size:16px;" onclick="generateSEOContent()">
              âœ¨ Generate with AI
            </button>
          </div>
          
          <div id="seoGenerationResult"></div>
        </div>
      `;
    }
    
    function switchSEOAITab(tab) {
      document.querySelectorAll('.tabs .tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      
      if (tab === 'generate') {
        showSEOAIStudio();
      } else if (tab === 'train') {
        showSEOTrainAI();
      } else if (tab === 'coaching') {
        showSEOCoaching();
      } else if (tab === 'history') {
        showSEOHistory();
      }
    }
    
    function showSEOTrainAI() {
      document.getElementById('seo-ai-content').innerHTML = `
        <div class="card fade-in">
          <div class="card-title">ğŸ“š Train AI - SEO Rules</div>
          <p style="color:var(--text-soft);margin-bottom:20px;">AI-ul a Ã®nvÄƒÈ›at din: <strong>24 reguli</strong> â”‚ <strong>18 exemple</strong> â”‚ <strong>12 feedback</strong></p>
          
          <!-- Add Rule -->
          <div style="display:flex;gap:10px;margin-bottom:20px;">
            <input type="text" class="input" placeholder="Add new SEO rule..." style="flex:1;">
            <button class="btn btn-success">+ Add Rule</button>
          </div>
          
          <!-- Rules List -->
          <div class="subtabs" style="margin-bottom:15px;">
            <div class="subtab active">ğŸ“œ Rules</div>
            <div class="subtab">âœ… Good Examples</div>
            <div class="subtab">âŒ Bad Examples</div>
            <div class="subtab">ğŸ’¬ Feedback</div>
          </div>
          
          <div class="result-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <span class="badge badge-error">Critical</span>
                <strong style="margin-left:10px;">#1 Meta title: 30-60 caractere</strong>
              </div>
              <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
            </div>
          </div>
          <div class="result-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <span class="badge badge-error">Critical</span>
                <strong style="margin-left:10px;">#2 Meta description: 120-160 caractere</strong>
              </div>
              <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
            </div>
          </div>
          <div class="result-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <span class="badge badge-warning">Medium</span>
                <strong style="margin-left:10px;">#3 Include brand "SuperParty" Ã®n title</strong>
              </div>
              <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
            </div>
          </div>
          <div class="result-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <span class="badge badge-warning">Medium</span>
                <strong style="margin-left:10px;">#4 Include "BucureÈ™ti" Ã®n title sau description</strong>
              </div>
              <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
            </div>
          </div>
        </div>
      `;
    }
    
    function showSEOCoaching() {
      document.getElementById('seo-ai-content').innerHTML = `
        <div class="card fade-in">
          <div class="card-title">ğŸ“ AI Self-Coaching</div>
          
          <div class="ai-recommendation">
            <span class="icon">ğŸ¯</span>
            <strong>AI Analysis (last 7 days):</strong>
          </div>
          
          <div class="result-card" style="border-left:4px solid #10B981;">
            <strong style="color:#10B981;">âœ… Strengths:</strong>
            <ul style="margin:10px 0 0 20px;color:var(--text-soft);">
              <li>Meta titles cu locaÈ›ie performeazÄƒ +15% mai bine</li>
              <li>Content cu 1000+ words are engagement mai mare</li>
              <li>Accuracy generÄƒri: 89% (â†‘ from 71%)</li>
            </ul>
          </div>
          
          <div class="result-card" style="border-left:4px solid #F59E0B;">
            <strong style="color:#F59E0B;">âš ï¸ Areas to improve:</strong>
            <ul style="margin:10px 0 0 20px;color:var(--text-soft);">
              <li>15% din meta titles sunt sub 30 caractere</li>
              <li>8% din pagini nu au schema markup</li>
            </ul>
          </div>
          
          <div class="result-card" style="border-left:4px solid #8B5CF6;">
            <strong style="color:#8B5CF6;">ğŸ’¡ Recommendations:</strong>
            <ul style="margin:10px 0 0 20px;color:var(--text-soft);">
              <li>AdaugÄƒ 5+ exemple de meta titles lungi</li>
              <li>CreeazÄƒ regulÄƒ pentru schema LocalBusiness</li>
            </ul>
          </div>
        </div>
      `;
    }
    
    function showSEOHistory() {
      document.getElementById('seo-ai-content').innerHTML = `
        <div class="card fade-in">
          <div class="card-title">ğŸ“œ Generation History</div>
          <table class="data-table">
            <thead>
              <tr><th>Date</th><th>Type</th><th>Brief</th><th>Quality</th><th>Status</th><th>Action</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Today, 14:30</td>
                <td>Full Page</td>
                <td>animatori sector 3...</td>
                <td><span class="badge badge-success">92%</span></td>
                <td><span class="badge badge-success">âœ… Approved</span></td>
                <td><button class="btn btn-secondary" style="padding:4px 8px;">View</button></td>
              </tr>
              <tr>
                <td>Yesterday</td>
                <td>Meta Tags</td>
                <td>arcade bucuresti...</td>
                <td><span class="badge badge-warning">78%</span></td>
                <td><span class="badge badge-warning">â³ Review</span></td>
                <td><button class="btn btn-secondary" style="padding:4px 8px;">View</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }
    
    function generateSEOContent() {
      const brief = document.getElementById('seoBrief')?.value;
      if (!brief || brief.length < 20) {
        showToast('Brief-ul e prea scurt! Minim 20 caractere.', 'warning');
        return;
      }
      
      document.getElementById('seoGenerationResult').innerHTML = `
        <div class="card fade-in">
          <div class="loading">
            <div class="spinner"></div>
            <div>âœ¨ AI genereazÄƒ conÈ›inut SEO...</div>
          </div>
        </div>
      `;
      
      setTimeout(() => {
        document.getElementById('seoGenerationResult').innerHTML = `
          <div class="card fade-in">
            <div class="card-title">
              <span>âœ… Generated Successfully!</span>
              <span class="badge badge-success">Quality: 92%</span>
            </div>
            
            <div class="result-card">
              <strong>Meta Title:</strong>
              <div style="margin:8px 0;font-size:18px;color:var(--primary);">Animatori Petreceri Copii Sector 3 BucureÈ™ti | SuperParty</div>
              <div class="char-counter">52/60 caractere âœ…</div>
            </div>
            
            <div class="result-card">
              <strong>Meta Description:</strong>
              <div style="margin:8px 0;">RezervÄƒ animatori profesioniÈ™ti pentru petreceri copii Ã®n Sector 3 BucureÈ™ti. Personaje Disney, Marvel È™i Unicorn. ExperienÈ›Äƒ 10+ ani. SunÄƒ acum!</div>
              <div class="char-counter">148/160 caractere âœ…</div>
            </div>
            
            <div class="result-card">
              <strong>Slug:</strong>
              <code style="background:var(--bg);padding:5px 10px;border-radius:4px;">/animatori-petreceri-copii-sector-3-bucuresti</code>
            </div>
            
            <div class="result-card">
              <strong>Content Preview:</strong>
              <div style="margin:8px 0;color:var(--text-soft);">
                <h3>Animatori Petreceri Copii Ã®n Sector 3 BucureÈ™ti</h3>
                <p>CÄƒutaÈ›i animatori de petreceri pentru copii Ã®n Sector 3 BucureÈ™ti? SuperParty oferÄƒ cele mai bune servicii de animaÈ›ie pentru petreceri memorabile...</p>
                <p><em>(1,245 words generated)</em></p>
              </div>
            </div>
            
            <div class="result-actions">
              <button class="btn btn-success">âœ… Approve & Save</button>
              <button class="btn btn-primary">âœï¸ Edit</button>
              <button class="btn btn-secondary">ğŸ’¬ Feedback to AI</button>
              <button class="btn btn-secondary">ğŸ“‹ Copy</button>
            </div>
          </div>
        `;
        showToast('âœ… Content generated successfully!', 'success');
      }, 2000);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ADS COMMAND CENTER - NOU
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    function showAdsDashboard() {
      currentGMPage = "ads-dashboard"; currentPage = null;
      pageTitle.textContent = "Ads Dashboard";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#F59E0B,#D97706);">
          <h2>ğŸ“¢ Ads Command Center</h2>
          <p>Overview complet al campaniilor Google Ads</p>
        </div>
        
        <!-- Stats -->
        <div class="stats-grid fade-in">
          <div class="stat-card orange">
            <div class="stat-value">2,340</div>
            <div class="stat-label">ğŸ’° Spend MTD (RON)</div>
          </div>
          <div class="stat-card green">
            <div class="stat-value">45</div>
            <div class="stat-label">ğŸ¯ Conversions</div>
            <div class="stat-change">+15% vs last month</div>
          </div>
          <div class="stat-card purple">
            <div class="stat-value">3.2x</div>
            <div class="stat-label">ğŸ“ˆ ROAS</div>
            <div class="stat-change">Target: 3x âœ…</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">52</div>
            <div class="stat-label">ğŸ’µ Cost/Conv (RON)</div>
            <div class="stat-change">-8% â†“</div>
          </div>
        </div>
        
        <!-- Budget Status -->
        <div class="card fade-in">
          <div class="card-title">ğŸ’° Budget Status</div>
          <div style="margin-bottom:15px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span>Monthly Budget: <strong>5,000 RON</strong></span>
              <span><strong>47%</strong> used (2,340 / 5,000)</span>
            </div>
            <div class="progress-bar" style="height:12px;">
              <div class="progress-fill blue" style="width:47%;"></div>
            </div>
            <div style="display:flex;justify-content:space-between;margin-top:8px;font-size:13px;color:var(--text-soft);">
              <span>Days left: 12</span>
              <span>Daily budget: 221 RON</span>
              <span style="color:#10B981;">âœ… On track</span>
            </div>
          </div>
        </div>
        
        <!-- Top Campaigns -->
        <div class="card fade-in">
          <div class="card-title">ğŸ† Top Campaigns</div>
          <table class="data-table">
            <thead>
              <tr><th>Campaign</th><th>Spend</th><th>Conv</th><th>ROAS</th><th>Status</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Animatori BucureÈ™ti</strong></td>
                <td>890 RON</td>
                <td>18</td>
                <td><span style="color:#10B981;font-weight:600;">4.1x</span></td>
                <td><span class="badge badge-success">ğŸŸ¢ Excellent</span></td>
              </tr>
              <tr>
                <td><strong>Baloane Heliu</strong></td>
                <td>650 RON</td>
                <td>12</td>
                <td><span style="color:#10B981;font-weight:600;">3.5x</span></td>
                <td><span class="badge badge-success">ğŸŸ¢ Good</span></td>
              </tr>
              <tr>
                <td><strong>Arcade Petreceri</strong></td>
                <td>420 RON</td>
                <td>8</td>
                <td><span style="color:#F59E0B;font-weight:600;">2.8x</span></td>
                <td><span class="badge badge-warning">ğŸŸ¡ Optimize</span></td>
              </tr>
              <tr>
                <td><strong>Brand Awareness</strong></td>
                <td>380 RON</td>
                <td>7</td>
                <td><span style="color:#EF4444;font-weight:600;">2.1x</span></td>
                <td><span class="badge badge-error">ğŸ”´ Review</span></td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <!-- AI Recommendation -->
        <div class="ai-recommendation fade-in">
          <span class="icon">ğŸ’¡</span>
          <strong>AI Recommendation:</strong> "Arcade Petreceri" has low ROAS. Suggest: add negative keywords "gratis", "free" and increase bid for "sector 1"
          <div style="margin-top:10px;">
            <button class="btn btn-success" style="padding:6px 12px;">âœ… Apply</button>
            <button class="btn btn-secondary" style="padding:6px 12px;">ğŸ‘ï¸ Details</button>
            <button class="btn btn-secondary" style="padding:6px 12px;">âŒ Dismiss</button>
          </div>
        </div>
      `;
    }

    function showAdsCampaigns() {
      currentGMPage = "ads-campaigns"; currentPage = null;
      pageTitle.textContent = "Campaigns";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#F59E0B,#D97706);">
          <h2>ğŸ¯ Campaigns</h2>
          <p>Manage È™i optimize campanii</p>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">
            <span>ğŸ“‹ All Campaigns</span>
            <button class="btn btn-success">+ New Campaign</button>
          </div>
          
          <table class="data-table">
            <thead>
              <tr><th>Campaign</th><th>Status</th><th>Budget</th><th>Spend</th><th>Clicks</th><th>Conv</th><th>ROAS</th><th>Actions</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Animatori BucureÈ™ti</strong></td>
                <td><span class="badge badge-success">Active</span></td>
                <td>1,500 RON</td>
                <td>890 RON</td>
                <td>456</td>
                <td>18</td>
                <td><span style="color:#10B981;">4.1x</span></td>
                <td>
                  <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
                  <button class="btn btn-secondary" style="padding:4px 8px;">ğŸ“Š</button>
                </td>
              </tr>
              <tr>
                <td><strong>Baloane Heliu</strong></td>
                <td><span class="badge badge-success">Active</span></td>
                <td>1,000 RON</td>
                <td>650 RON</td>
                <td>312</td>
                <td>12</td>
                <td><span style="color:#10B981;">3.5x</span></td>
                <td>
                  <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
                  <button class="btn btn-secondary" style="padding:4px 8px;">ğŸ“Š</button>
                </td>
              </tr>
              <tr>
                <td><strong>Arcade Petreceri</strong></td>
                <td><span class="badge badge-success">Active</span></td>
                <td>800 RON</td>
                <td>420 RON</td>
                <td>189</td>
                <td>8</td>
                <td><span style="color:#F59E0B;">2.8x</span></td>
                <td>
                  <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
                  <button class="btn btn-secondary" style="padding:4px 8px;">ğŸ“Š</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }

    function showAdsKeywords() {
      currentGMPage = "ads-keywords"; currentPage = null;
      pageTitle.textContent = "Keywords & Targeting";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#F59E0B,#D97706);">
          <h2>ğŸ”‘ Keywords & Targeting</h2>
          <p>Manage keywords, audiences È™i targeting</p>
        </div>
        
        <div class="subtabs fade-in">
          <div class="subtab active">ğŸ”‘ Keywords</div>
          <div class="subtab">ğŸš« Negatives</div>
          <div class="subtab">ğŸ‘¥ Audiences</div>
          <div class="subtab">ğŸ“ Locations</div>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">
            <span>ğŸ”‘ Ad Keywords</span>
            <button class="btn btn-success">+ Add Keywords</button>
          </div>
          
          <table class="data-table">
            <thead>
              <tr><th>Keyword</th><th>Match</th><th>Clicks</th><th>CPC</th><th>Conv</th><th>Quality</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>animatori petreceri copii</strong></td>
                <td><span class="badge badge-info">Phrase</span></td>
                <td>234</td>
                <td>1.2 RON</td>
                <td>12</td>
                <td><span class="badge badge-success">9/10</span></td>
              </tr>
              <tr>
                <td><strong>animatori bucuresti</strong></td>
                <td><span class="badge badge-purple">Exact</span></td>
                <td>156</td>
                <td>1.5 RON</td>
                <td>8</td>
                <td><span class="badge badge-success">8/10</span></td>
              </tr>
              <tr>
                <td><strong>baloane cu heliu</strong></td>
                <td><span class="badge badge-info">Phrase</span></td>
                <td>98</td>
                <td>0.9 RON</td>
                <td>5</td>
                <td><span class="badge badge-warning">6/10</span></td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">ğŸš« Negative Keywords</div>
          <div style="display:flex;flex-wrap:wrap;gap:8px;">
            <span class="badge" style="background:#fee2e2;color:#dc2626;padding:8px 12px;">gratis âœ•</span>
            <span class="badge" style="background:#fee2e2;color:#dc2626;padding:8px 12px;">free âœ•</span>
            <span class="badge" style="background:#fee2e2;color:#dc2626;padding:8px 12px;">ieftin âœ•</span>
            <span class="badge" style="background:#fee2e2;color:#dc2626;padding:8px 12px;">job âœ•</span>
            <span class="badge" style="background:#fee2e2;color:#dc2626;padding:8px 12px;">angajare âœ•</span>
            <button class="btn btn-secondary" style="padding:8px 12px;">+ Add</button>
          </div>
        </div>
      `;
    }

    function showAdsLibrary() {
      currentGMPage = "ads-library"; currentPage = null;
      pageTitle.textContent = "Ads Library";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#F59E0B,#D97706);">
          <h2>ğŸ“ Ads Library</h2>
          <p>All ads, A/B tests È™i templates</p>
        </div>
        
        <div class="subtabs fade-in">
          <div class="subtab active">All Ads</div>
          <div class="subtab">âœ… Active</div>
          <div class="subtab">â¸ï¸ Paused</div>
          <div class="subtab">ğŸ”¬ A/B Tests</div>
          <div class="subtab">ğŸ“‹ Templates</div>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">
            <span>ğŸ“¢ Ad #1 - Animatori BucureÈ™ti</span>
            <span class="badge badge-success">Active</span>
          </div>
          
          <div style="display:flex;gap:10px;margin-bottom:10px;">
            <span class="badge badge-purple">ğŸ­ Emotional</span>
            <span style="color:var(--text-soft);font-size:13px;">CTR: 4.2% â”‚ Conv: 12 â”‚ Quality: 8/10</span>
          </div>
          
          <div class="result-card">
            <div style="margin-bottom:8px;"><strong>H1:</strong> Animatori Petreceri BucureÈ™ti <span class="char-counter">(28/30) âœ…</span></div>
            <div style="margin-bottom:8px;"><strong>H2:</strong> Personaje Disney & Marvel <span class="char-counter">(23/30) âœ…</span></div>
            <div style="margin-bottom:8px;"><strong>H3:</strong> RezervÄƒ Acum - Disponibil! <span class="char-counter">(25/30) âœ…</span></div>
          </div>
          
          <div class="result-card">
            <div style="margin-bottom:8px;"><strong>D1:</strong> TransformÄƒm petrecerea copilului tÄƒu Ã®ntr-o aventurÄƒ magicÄƒ. Animatori profesioniÈ™ti. <span class="char-counter">(87/90) âœ…</span></div>
            <div><strong>D2:</strong> Pachete de la 500 lei. SunÄƒ acum! <span class="char-counter">(35/90) âœ…</span></div>
          </div>
          
          <div class="result-actions">
            <button class="btn btn-secondary">âœï¸ Edit</button>
            <button class="btn btn-secondary">ğŸ“‹ Duplicate</button>
            <button class="btn btn-secondary">â¸ï¸ Pause</button>
            <button class="btn btn-primary">ğŸ¤– Optimize with AI</button>
          </div>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">
            <span>ğŸ”¬ A/B Test Running</span>
            <span class="badge badge-info">5 days active</span>
          </div>
          <div style="margin-bottom:15px;"><strong>Test:</strong> Emotional vs Practic headline</div>
          <div class="grid-2">
            <div class="result-card" style="border-left:4px solid #10B981;">
              <strong>Variant A (Emotional)</strong>
              <div style="margin-top:10px;">CTR: 4.2% â”‚ Conv: 12</div>
              <div style="color:#10B981;font-weight:600;margin-top:5px;">ğŸ† Current Winner (+10.5%)</div>
            </div>
            <div class="result-card">
              <strong>Variant B (Practic)</strong>
              <div style="margin-top:10px;">CTR: 3.8% â”‚ Conv: 9</div>
            </div>
          </div>
          <div class="result-actions">
            <button class="btn btn-secondary">ğŸ“Š Full Report</button>
            <button class="btn btn-error">â¹ï¸ End Test</button>
          </div>
        </div>
      `;
    }

    function showAdsBudget() {
      currentGMPage = "ads-budget"; currentPage = null;
      pageTitle.textContent = "Budget & Pacing";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#F59E0B,#D97706);">
          <h2>ğŸ’° Budget & Pacing</h2>
          <p>Control budgets È™i spend pacing</p>
        </div>
        
        <div class="stats-grid fade-in">
          <div class="stat-card orange">
            <div class="stat-value">5,000</div>
            <div class="stat-label">ğŸ’° Monthly Budget (RON)</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">2,340</div>
            <div class="stat-label">ğŸ“Š Spent MTD</div>
          </div>
          <div class="stat-card green">
            <div class="stat-value">2,660</div>
            <div class="stat-label">ğŸ’µ Remaining</div>
          </div>
          <div class="stat-card purple">
            <div class="stat-value">221</div>
            <div class="stat-label">ğŸ“… Daily Target</div>
          </div>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">ğŸ“Š Budget Allocation by Campaign</div>
          
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span><strong>Animatori BucureÈ™ti</strong></span>
              <span>890 / 1,500 RON (59%)</span>
            </div>
            <div class="progress-bar"><div class="progress-fill green" style="width:59%;"></div></div>
          </div>
          
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span><strong>Baloane Heliu</strong></span>
              <span>650 / 1,000 RON (65%)</span>
            </div>
            <div class="progress-bar"><div class="progress-fill blue" style="width:65%;"></div></div>
          </div>
          
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span><strong>Arcade Petreceri</strong></span>
              <span>420 / 800 RON (52%)</span>
            </div>
            <div class="progress-bar"><div class="progress-fill orange" style="width:52%;"></div></div>
          </div>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">âš™ï¸ Budget Settings</div>
          <div class="grid-2">
            <div class="form-group">
              <label>Monthly Budget (RON)</label>
              <input type="number" class="input" value="5000">
            </div>
            <div class="form-group">
              <label>Pacing Strategy</label>
              <select class="select">
                <option selected>Standard (spread evenly)</option>
                <option>Accelerated (spend fast)</option>
                <option>Manual (set daily limits)</option>
              </select>
            </div>
          </div>
          <button class="btn btn-primary">ğŸ’¾ Save Settings</button>
        </div>
      `;
    }

    function showAdsAIStudio() {
      currentGMPage = "ads-ai-studio"; currentPage = null;
      pageTitle.textContent = "Ads AI Studio";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#F59E0B,#D97706);">
          <h2>ğŸ¤– Ads AI Studio</h2>
          <p>Generate, Train È™i Optimize Ads cu AI</p>
        </div>
        
        <div class="tabs fade-in">
          <div class="tab active" onclick="switchAdsAITab('generate')">âœ¨ Generate</div>
          <div class="tab" onclick="switchAdsAITab('train')">ğŸ“š Train AI</div>
          <div class="tab" onclick="switchAdsAITab('coaching')">ğŸ“ Coaching</div>
          <div class="tab" onclick="switchAdsAITab('history')">ğŸ“œ History</div>
        </div>
        
        <div id="ads-ai-content">
          <div class="card fade-in">
            <div class="card-title">âœ¨ Generate New Ads</div>
            
            <div class="form-group">
              <label>Campaign:</label>
              <select class="select">
                <option>Animatori BucureÈ™ti</option>
                <option>Baloane Heliu</option>
                <option>Arcade Petreceri</option>
                <option>+ New Campaign</option>
              </select>
            </div>
            
            <div class="form-group">
              <label>Brief:</label>
              <textarea class="textarea" id="adsBrief" placeholder="Exemplu: GenereazÄƒ 5 ads pentru animatori petreceri copii, focus pe sectorul 3, menÈ›ioneazÄƒ preÈ› de la 500 lei, urgenÈ›Äƒ È™i disponibilitate weekend..."></textarea>
            </div>
            
            <div class="grid-2">
              <div class="form-group">
                <label>Number of Ads:</label>
                <select class="select">
                  <option>3 ads</option>
                  <option selected>5 ads</option>
                  <option>10 ads</option>
                </select>
              </div>
              <div class="form-group">
                <label>Angles to include:</label>
                <div class="toggle-group">
                  <div class="toggle-btn active">ğŸ­ Emotional</div>
                  <div class="toggle-btn active">ğŸ“‹ Practic</div>
                  <div class="toggle-btn active">âš¡ UrgenÈ›Äƒ</div>
                  <div class="toggle-btn active">ğŸ OfertÄƒ</div>
                </div>
              </div>
            </div>
            
            <button class="btn btn-warning" style="width:100%;padding:15px;font-size:16px;" onclick="generateAdsContent()">
              âœ¨ Generate Ads with AI
            </button>
          </div>
          
          <div id="adsGenerationResult"></div>
        </div>
      `;
    }
    
    function switchAdsAITab(tab) {
      document.querySelectorAll('.tabs .tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      
      if (tab === 'generate') {
        showAdsAIStudio();
      } else if (tab === 'train') {
        showAdsTrainAI();
      } else if (tab === 'coaching') {
        showAdsCoaching();
      } else if (tab === 'history') {
        showAdsHistory();
      }
    }
    
    function showAdsTrainAI() {
      document.getElementById('ads-ai-content').innerHTML = `
        <div class="card fade-in">
          <div class="card-title">ğŸ“š Train AI - Ads Rules</div>
          <p style="color:var(--text-soft);margin-bottom:20px;">AI-ul a Ã®nvÄƒÈ›at din: <strong>18 reguli</strong> â”‚ <strong>25 exemple</strong> â”‚ <strong>8 feedback</strong></p>
          
          <div style="display:flex;gap:10px;margin-bottom:20px;">
            <input type="text" class="input" placeholder="Add new Ads rule..." style="flex:1;">
            <button class="btn btn-warning">+ Add Rule</button>
          </div>
          
          <div class="result-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <span class="badge badge-error">Critical</span>
                <strong style="margin-left:10px;">#1 Headline max 30 caractere</strong>
              </div>
              <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
            </div>
          </div>
          <div class="result-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <span class="badge badge-error">Critical</span>
                <strong style="margin-left:10px;">#2 Description max 90 caractere</strong>
              </div>
              <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
            </div>
          </div>
          <div class="result-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <span class="badge badge-warning">Medium</span>
                <strong style="margin-left:10px;">#3 Include locaÈ›ie Ã®n H1 sau D1</strong>
              </div>
              <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
            </div>
          </div>
          <div class="result-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <span class="badge badge-warning">Medium</span>
                <strong style="margin-left:10px;">#4 CTA obligatoriu: SunÄƒ, RezervÄƒ, ComandÄƒ</strong>
              </div>
              <button class="btn btn-secondary" style="padding:4px 8px;">âœï¸</button>
            </div>
          </div>
        </div>
      `;
    }
    
    function showAdsCoaching() {
      document.getElementById('ads-ai-content').innerHTML = `
        <div class="card fade-in">
          <div class="card-title">ğŸ“ AI Ads Coaching</div>
          
          <div class="ai-recommendation">
            <span class="icon">ğŸ¯</span>
            <strong>AI Analysis (last 7 days):</strong>
          </div>
          
          <div class="result-card" style="border-left:4px solid #10B981;">
            <strong style="color:#10B981;">âœ… Strengths:</strong>
            <ul style="margin:10px 0 0 20px;color:var(--text-soft);">
              <li>Headlines cu locaÈ›ie performeazÄƒ +15% mai bine</li>
              <li>Angle "Emotional" are cel mai bun CTR</li>
              <li>Ads quality score average: 8.2/10</li>
            </ul>
          </div>
          
          <div class="result-card" style="border-left:4px solid #F59E0B;">
            <strong style="color:#F59E0B;">âš ï¸ Areas to improve:</strong>
            <ul style="margin:10px 0 0 20px;color:var(--text-soft);">
              <li>23% din ads nu au CTA clar</li>
              <li>Description 2 este subutilizat Ã®n 40% din ads</li>
            </ul>
          </div>
          
          <div class="result-card" style="border-left:4px solid #8B5CF6;">
            <strong style="color:#8B5CF6;">ğŸ’¡ Recommendations:</strong>
            <ul style="margin:10px 0 0 20px;color:var(--text-soft);">
              <li>AdaugÄƒ "SunÄƒ acum" Ã®n toate ad-urile</li>
              <li>TesteazÄƒ headline cu preÈ› explicit</li>
              <li>AdaugÄƒ 10 exemple noi de ads "emotional"</li>
            </ul>
          </div>
        </div>
      `;
    }
    
    function showAdsHistory() {
      document.getElementById('ads-ai-content').innerHTML = `
        <div class="card fade-in">
          <div class="card-title">ğŸ“œ Ads Generation History</div>
          <table class="data-table">
            <thead>
              <tr><th>Date</th><th>Campaign</th><th>Ads</th><th>Quality</th><th>Status</th><th>Action</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Today, 15:45</td>
                <td>Animatori BucureÈ™ti</td>
                <td>5 ads</td>
                <td><span class="badge badge-success">88%</span></td>
                <td><span class="badge badge-success">âœ… Live</span></td>
                <td><button class="btn btn-secondary" style="padding:4px 8px;">View</button></td>
              </tr>
              <tr>
                <td>Yesterday</td>
                <td>Baloane Heliu</td>
                <td>3 ads</td>
                <td><span class="badge badge-warning">75%</span></td>
                <td><span class="badge badge-warning">â³ Review</span></td>
                <td><button class="btn btn-secondary" style="padding:4px 8px;">View</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      `;
    }
    
    function generateAdsContent() {
      const brief = document.getElementById('adsBrief')?.value;
      if (!brief || brief.length < 20) {
        showToast('Brief-ul e prea scurt! Minim 20 caractere.', 'warning');
        return;
      }
      
      document.getElementById('adsGenerationResult').innerHTML = `
        <div class="card fade-in">
          <div class="loading">
            <div class="spinner"></div>
            <div>âœ¨ AI genereazÄƒ ads...</div>
          </div>
        </div>
      `;
      
      setTimeout(() => {
        document.getElementById('adsGenerationResult').innerHTML = `
          <div class="card fade-in">
            <div class="card-title">
              <span>âœ… 5 Ads Generated!</span>
              <span class="badge badge-success">Quality: 88%</span>
            </div>
            
            <div class="result-card">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                <strong>ğŸ“¢ Ad #1</strong>
                <span class="badge badge-purple">ğŸ­ Emotional</span>
              </div>
              <div style="margin-bottom:5px;"><strong>H1:</strong> Animatori Petreceri BucureÈ™ti <span style="color:var(--success);">(28/30) âœ…</span></div>
              <div style="margin-bottom:5px;"><strong>H2:</strong> Magie Pentru Copilul TÄƒu! <span style="color:var(--success);">(24/30) âœ…</span></div>
              <div style="margin-bottom:5px;"><strong>D1:</strong> TransformÄƒm petrecerea Ã®ntr-o aventurÄƒ de neuitat. Personaje Disney È™i Marvel. <span style="color:var(--success);">(78/90) âœ…</span></div>
              <div><strong>D2:</strong> De la 500 lei. SunÄƒ acum: 0728 242 214 <span style="color:var(--success);">(40/90) âœ…</span></div>
            </div>
            
            <div class="result-card">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                <strong>ğŸ“¢ Ad #2</strong>
                <span class="badge" style="background:#dbeafe;color:#2563eb;">ğŸ“‹ Practic</span>
              </div>
              <div style="margin-bottom:5px;"><strong>H1:</strong> Animatori Sector 3 BucureÈ™ti <span style="color:var(--success);">(27/30) âœ…</span></div>
              <div style="margin-bottom:5px;"><strong>H2:</strong> Disponibili Weekend! <span style="color:var(--success);">(19/30) âœ…</span></div>
              <div style="margin-bottom:5px;"><strong>D1:</strong> Pachete complete: animatori + decoraÈ›iuni + candy bar. ExperienÈ›Äƒ 10+ ani. <span style="color:var(--success);">(74/90) âœ…</span></div>
              <div><strong>D2:</strong> RezervÄƒ locul acum! Locuri limitate. <span style="color:var(--success);">(36/90) âœ…</span></div>
            </div>
            
            <div style="text-align:center;color:var(--text-soft);padding:10px;">+ 3 more ads generated...</div>
            
            <div class="result-actions">
              <button class="btn btn-success">âœ… Approve All</button>
              <button class="btn btn-primary">ğŸ‘ï¸ Review Each</button>
              <button class="btn btn-secondary">ğŸ’¬ Feedback to AI</button>
              <button class="btn btn-secondary">ğŸ“‹ Export</button>
            </div>
          </div>
        `;
        showToast('âœ… 5 ads generated successfully!', 'success');
      }, 2000);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PERFORMANCE HUB - NOU
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    function showPerfUnified() {
      currentGMPage = "perf-unified"; currentPage = null;
      pageTitle.textContent = "Unified Dashboard";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#3B82F6,#2563EB);">
          <h2>ğŸ“ˆ Performance Hub</h2>
          <p>SEO + Ads unified view</p>
        </div>
        
        <!-- Overall Score -->
        <div class="card fade-in">
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:20px;text-align:center;">
            <div>
              <div style="font-size:14px;color:var(--text-soft);margin-bottom:5px;">SEO Score</div>
              <div style="font-size:48px;font-weight:700;color:#10B981;">78</div>
            </div>
            <div style="border-left:1px solid var(--border);border-right:1px solid var(--border);">
              <div style="font-size:14px;color:var(--text-soft);margin-bottom:5px;">Combined</div>
              <div style="font-size:48px;font-weight:700;color:#3B82F6;">82</div>
              <div style="font-size:24px;">â­â­â­â­</div>
            </div>
            <div>
              <div style="font-size:14px;color:var(--text-soft);margin-bottom:5px;">Ads Score</div>
              <div style="font-size:48px;font-weight:700;color:#F59E0B;">85</div>
            </div>
          </div>
        </div>
        
        <!-- Traffic Sources -->
        <div class="card fade-in">
          <div class="card-title">ğŸ“Š Traffic Sources (Last 30 Days)</div>
          <div style="margin-bottom:15px;">
            <strong>Total Traffic: 5,234 visits</strong>
            <span style="color:#10B981;margin-left:10px;">+12% vs last month</span>
          </div>
          
          <div style="margin-bottom:15px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:5px;">
              <span>ğŸ” Organic (SEO)</span>
              <strong>62% (3,245)</strong>
            </div>
            <div class="progress-bar"><div class="progress-fill green" style="width:62%;"></div></div>
          </div>
          
          <div style="margin-bottom:15px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:5px;">
              <span>ğŸ“¢ Paid (Ads)</span>
              <strong>31% (1,622)</strong>
            </div>
            <div class="progress-bar"><div class="progress-fill orange" style="width:31%;"></div></div>
          </div>
          
          <div>
            <div style="display:flex;justify-content:space-between;margin-bottom:5px;">
              <span>ğŸ”— Direct</span>
              <strong>7% (367)</strong>
            </div>
            <div class="progress-bar"><div class="progress-fill purple" style="width:7%;"></div></div>
          </div>
        </div>
        
        <!-- Conversions -->
        <div class="card fade-in">
          <div class="card-title">ğŸ¯ Conversions</div>
          <div class="stats-grid">
            <div class="stat-card green">
              <div class="stat-value">89</div>
              <div class="stat-label">Total Conversions</div>
              <div class="stat-change">+18% vs last month</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">52</div>
              <div class="stat-label">From SEO (58%)</div>
              <div class="stat-change">Cost: 0 RON ğŸ‰</div>
            </div>
            <div class="stat-card orange">
              <div class="stat-value">37</div>
              <div class="stat-label">From Ads (42%)</div>
              <div class="stat-change">Cost: 2,340 RON</div>
            </div>
            <div class="stat-card purple">
              <div class="stat-value">1,806%</div>
              <div class="stat-label">Total ROI</div>
              <div class="stat-change">ğŸš€ Excellent!</div>
            </div>
          </div>
        </div>
      `;
    }

    function showPerfCalendar() {
      currentGMPage = "perf-calendar"; currentPage = null;
      pageTitle.textContent = "Content Calendar";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#3B82F6,#2563EB);">
          <h2>ğŸ“… Content Calendar</h2>
          <p>Plan editorial SEO + Ads</p>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">
            <span>ğŸ“… Noiembrie 2024</span>
            <div>
              <button class="btn btn-secondary" style="padding:5px 10px;">â† Prev</button>
              <button class="btn btn-secondary" style="padding:5px 10px;">Next â†’</button>
            </div>
          </div>
          
          <table class="data-table">
            <thead>
              <tr><th>Week</th><th>Luni</th><th>MarÈ›i</th><th>Miercuri</th><th>Joi</th><th>Vineri</th></tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>W48</strong></td>
                <td style="background:#d1fae5;">ğŸ“ SEO<br><small>animatori-s3</small></td>
                <td>-</td>
                <td style="background:#fef3c7;">ğŸ“¢ Ads<br><small>New campaign</small></td>
                <td>-</td>
                <td style="background:#dbeafe;">ğŸ“Š Review</td>
              </tr>
              <tr>
                <td><strong>W49</strong></td>
                <td style="background:#d1fae5;">ğŸ“ SEO<br><small>arcade-buc</small></td>
                <td>-</td>
                <td style="background:#d1fae5;">ğŸ“ SEO<br><small>baloane-s1</small></td>
                <td>-</td>
                <td style="background:#dbeafe;">ğŸ“Š Review</td>
              </tr>
              <tr>
                <td><strong>W50</strong></td>
                <td style="background:#d1fae5;">ğŸ“ SEO<br><small>animatori-s4</small></td>
                <td style="background:#fef3c7;">ğŸ“¢ Ads<br><small>A/B test</small></td>
                <td>-</td>
                <td>-</td>
                <td style="background:#ede9fe;">ğŸ“„ Report</td>
              </tr>
            </tbody>
          </table>
          
          <div style="margin-top:20px;display:flex;gap:20px;font-size:13px;">
            <span><span style="display:inline-block;width:12px;height:12px;background:#d1fae5;border-radius:2px;margin-right:5px;"></span> SEO Content</span>
            <span><span style="display:inline-block;width:12px;height:12px;background:#fef3c7;border-radius:2px;margin-right:5px;"></span> Ads</span>
            <span><span style="display:inline-block;width:12px;height:12px;background:#dbeafe;border-radius:2px;margin-right:5px;"></span> Review</span>
            <span><span style="display:inline-block;width:12px;height:12px;background:#ede9fe;border-radius:2px;margin-right:5px;"></span> Report</span>
          </div>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">â• Add to Calendar</div>
          <div class="grid-2">
            <div class="form-group">
              <label>Type:</label>
              <select class="select">
                <option>ğŸ“ SEO Content</option>
                <option>ğŸ“¢ Ads Campaign</option>
                <option>ğŸ“Š Review</option>
                <option>ğŸ“„ Report</option>
              </select>
            </div>
            <div class="form-group">
              <label>Date:</label>
              <input type="date" class="input">
            </div>
          </div>
          <div class="form-group">
            <label>Description:</label>
            <input type="text" class="input" placeholder="What's planned...">
          </div>
          <button class="btn btn-primary">â• Add to Calendar</button>
        </div>
      `;
    }

    function showPerfGoals() {
      currentGMPage = "perf-goals"; currentPage = null;
      pageTitle.textContent = "Goals & KPIs";
      
      content.innerHTML = `
        <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#3B82F6,#2563EB);">
          <h2>ğŸ¯ Goals & KPIs</h2>
          <p>Track obiective È™i performanÈ›Äƒ</p>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">ğŸ“Š Weekly Goals</div>
          
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span>â˜‘ï¸ Publish 2 new SEO pages</span>
              <strong style="color:#10B981;">2/2 âœ…</strong>
            </div>
            <div class="progress-bar"><div class="progress-fill green" style="width:100%;"></div></div>
          </div>
          
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span>â˜ Reach 1,500 organic clicks</span>
              <strong style="color:#F59E0B;">1,234/1,500 (82%)</strong>
            </div>
            <div class="progress-bar"><div class="progress-fill orange" style="width:82%;"></div></div>
          </div>
          
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span>â˜‘ï¸ Maintain ROAS > 3x</span>
              <strong style="color:#10B981;">3.2x âœ…</strong>
            </div>
            <div class="progress-bar"><div class="progress-fill green" style="width:100%;"></div></div>
          </div>
          
          <div style="margin-bottom:20px;">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <span>â˜ Add 10 new keywords to tracking</span>
              <strong style="color:#F59E0B;">6/10 (60%)</strong>
            </div>
            <div class="progress-bar"><div class="progress-fill orange" style="width:60%;"></div></div>
          </div>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">ğŸ¯ Monthly KPIs</div>
          <table class="data-table">
            <thead>
              <tr><th>KPI</th><th>Target</th><th>Current</th><th>Status</th></tr>
            </thead>
            <tbody>
              <tr>
                <td>Organic Traffic</td>
                <td>4,000</td>
                <td>3,245</td>
                <td><span class="badge badge-warning">81%</span></td>
              </tr>
              <tr>
                <td>Conversions</td>
                <td>80</td>
                <td>89</td>
                <td><span class="badge badge-success">111% âœ…</span></td>
              </tr>
              <tr>
                <td>ROAS</td>
                <td>3x</td>
                <td>3.2x</td>
                <td><span class="badge badge-success">107% âœ…</span></td>
              </tr>
              <tr>
                <td>SEO Score</td>
                <td>80</td>
                <td>78</td>
                <td><span class="badge badge-warning">98%</span></td>
              </tr>
              <tr>
                <td>New Pages</td>
                <td>8</td>
                <td>6</td>
                <td><span class="badge badge-warning">75%</span></td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <div class="card fade-in">
          <div class="card-title">â• Add New Goal</div>
          <div class="grid-2">
            <div class="form-group">
              <label>Goal Name:</label>
              <input type="text" class="input" placeholder="E.g., Reach 5,000 organic visits">
            </div>
            <div class="form-group">
              <label>Target Value:</label>
              <input type="number" class="input" placeholder="5000">
            </div>
          </div>
          <button class="btn btn-primary">â• Add Goal</button>
        </div>
      `;
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // BUDGET & AI - NOU
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async function showBudgetDashboard() {
      currentGMPage = "budget-dashboard"; currentPage = null;
      pageTitle.textContent = "ğŸ’° Budget Dashboard";
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ bugetul...</div></div>';
      
      try {
        const r = await fetch(BACKEND_URL + '?action=getBudgetDetails');
        const d = await r.json();
        
        if (d.ok) {
          const data = d.data;
          const usagePct = data.usagePercentage || 0;
          const barColor = usagePct >= data.criticalPct ? '#ef4444' : (usagePct >= data.warningPct ? '#f59e0b' : '#10b981');
          
          let warningsHtml = '';
          if (data.warnings && data.warnings.length > 0) {
            warningsHtml = '<div class="card fade-in" style="background:#fef2f2;border:1px solid #fecaca;">';
            data.warnings.forEach(w => {
              warningsHtml += `<div style="color:#dc2626;font-weight:600;">âš ï¸ ${w.message}</div>`;
            });
            warningsHtml += '</div>';
          }
          
          let providersHtml = '';
          const providerColors = { openai: '#10B981', gemini: '#3B82F6', claude: '#F59E0B', nano_banana: '#8B5CF6' };
          const providerNames = { openai: 'ğŸŸ¢ OpenAI (GPT-4o)', gemini: 'ğŸ”µ Gemini', claude: 'ğŸŸ  Claude', nano_banana: 'ğŸŸ¡ Nano Banana' };
          
          for (const provider in data.byProvider) {
            const p = data.byProvider[provider];
            const pName = providerNames[provider] || provider;
            const pColor = providerColors[provider] || '#6b7280';
            providersHtml += `
              <div style="display:flex;justify-content:space-between;align-items:center;padding:12px;background:var(--bg);border-radius:8px;margin-bottom:8px;">
                <span>${pName}</span>
                <div style="text-align:right;">
                  <strong style="color:${pColor};">â‚¬${p.spent?.toFixed(4) || '0.0000'}</strong>
                  <div style="font-size:11px;color:var(--text-soft);">${p.percentage?.toFixed(1) || 0}% din total</div>
                </div>
              </div>
            `;
          }
          
          if (!providersHtml) {
            providersHtml = '<div class="empty-state">Niciun cost Ã®nregistrat Ã®ncÄƒ</div>';
          }
          
          content.innerHTML = `
            <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#10B981,#059669);">
              <h2>ğŸ’° Budget AI - ${data.month || 'Luna curentÄƒ'}</h2>
              <p>Monitorizare costuri pentru toate AI-urile</p>
            </div>
            
            ${warningsHtml}
            
            <div class="card fade-in">
              <div class="card-title">ğŸ“Š Utilizare Buget</div>
              
              <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:15px;margin-bottom:25px;">
                <div class="stat-card" style="background:#f0fdf4;border-left:4px solid #10b981;">
                  <div style="font-size:11px;color:#6b7280;">BUGET LUNAR</div>
                  <div style="font-size:24px;font-weight:700;color:#10b981;">â‚¬${data.limitEUR?.toFixed(2) || '50.00'}</div>
                </div>
                <div class="stat-card" style="background:#fef3c7;border-left:4px solid #f59e0b;">
                  <div style="font-size:11px;color:#6b7280;">CONSUMAT</div>
                  <div style="font-size:24px;font-weight:700;color:#f59e0b;">â‚¬${data.spentEUR?.toFixed(4) || '0.0000'}</div>
                </div>
                <div class="stat-card" style="background:#eff6ff;border-left:4px solid #3b82f6;">
                  <div style="font-size:11px;color:#6b7280;">RÄ‚MAS</div>
                  <div style="font-size:24px;font-weight:700;color:#3b82f6;">â‚¬${data.remainingEUR?.toFixed(4) || '50.0000'}</div>
                </div>
                <div class="stat-card" style="background:#f5f3ff;border-left:4px solid #8b5cf6;">
                  <div style="font-size:11px;color:#6b7280;">ACÈšIUNI</div>
                  <div style="font-size:24px;font-weight:700;color:#8b5cf6;">${data.actionsUsed || 0}</div>
                </div>
              </div>
              
              <div style="margin-bottom:15px;">
                <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                  <span>Utilizare buget</span>
                  <strong style="color:${barColor};">${usagePct.toFixed(1)}%</strong>
                </div>
                <div style="background:#e2e8f0;border-radius:10px;height:24px;overflow:hidden;">
                  <div style="background:${barColor};height:100%;width:${Math.min(usagePct, 100)}%;border-radius:10px;transition:width 0.5s;"></div>
                </div>
                <div style="display:flex;justify-content:space-between;margin-top:5px;font-size:11px;color:var(--text-soft);">
                  <span>Warning: ${data.warningPct || 80}%</span>
                  <span>Critical: ${data.criticalPct || 95}%</span>
                </div>
              </div>
            </div>
            
            <div class="card fade-in">
              <div class="card-title">ğŸ¤– Cost per Provider</div>
              ${providersHtml}
            </div>
            
            <div class="card fade-in">
              <div class="card-title">âš¡ AI Status</div>
              <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;">
                <div style="padding:15px;background:${data.aiEnabled?.openai ? '#f0fdf4' : '#fef2f2'};border-radius:8px;text-align:center;">
                  <div style="font-size:24px;">ğŸŸ¢</div>
                  <div style="font-weight:600;">GPT-4o</div>
                  <div style="font-size:12px;color:${data.aiEnabled?.openai ? '#22c55e' : '#ef4444'};">${data.aiEnabled?.openai ? 'âœ… Activ' : 'âŒ Inactiv'}</div>
                </div>
                <div style="padding:15px;background:${data.aiEnabled?.gemini ? '#eff6ff' : '#fef2f2'};border-radius:8px;text-align:center;">
                  <div style="font-size:24px;">ğŸ”µ</div>
                  <div style="font-weight:600;">Gemini</div>
                  <div style="font-size:12px;color:${data.aiEnabled?.gemini ? '#22c55e' : '#ef4444'};">${data.aiEnabled?.gemini ? 'âœ… Activ' : 'âŒ Inactiv'}</div>
                </div>
                <div style="padding:15px;background:${data.aiEnabled?.claude ? '#fef3c7' : '#fef2f2'};border-radius:8px;text-align:center;">
                  <div style="font-size:24px;">ğŸŸ </div>
                  <div style="font-weight:600;">Claude</div>
                  <div style="font-size:12px;color:${data.aiEnabled?.claude ? '#22c55e' : '#ef4444'};">${data.aiEnabled?.claude ? 'âœ… Activ' : 'âŒ Inactiv'}</div>
                </div>
                <div style="padding:15px;background:${data.aiEnabled?.nanoBanana ? '#f5f3ff' : '#fef2f2'};border-radius:8px;text-align:center;">
                  <div style="font-size:24px;">ğŸŸ¡</div>
                  <div style="font-weight:600;">Nano Banana</div>
                  <div style="font-size:12px;color:${data.aiEnabled?.nanoBanana ? '#22c55e' : '#ef4444'};">${data.aiEnabled?.nanoBanana ? 'âœ… Activ' : 'âŒ Inactiv'}</div>
                </div>
              </div>
            </div>
            
            <div style="display:flex;gap:10px;margin-top:20px;">
              <button class="btn btn-primary" onclick="showBudgetSettings()">âš™ï¸ ModificÄƒ SetÄƒri</button>
              <button class="btn btn-secondary" onclick="showBudgetHistory()">ğŸ“œ Istoric Cheltuieli</button>
              <button class="btn btn-secondary" onclick="showBudgetErrors()">âš ï¸ Vezi Erori</button>
              <button class="btn btn-purple" onclick="showSelfHealing()">ğŸ”§ Self-Healing</button>
            </div>
          `;
        } else {
          content.innerHTML = '<div class="card"><div class="empty-state">âŒ Eroare la Ã®ncÄƒrcarea bugetului</div></div>';
        }
      } catch (e) {
        content.innerHTML = `<div class="card"><div class="empty-state">âŒ Eroare: ${e.message}</div></div>`;
      }
    }
    
    async function showBudgetSettings() {
      currentGMPage = "budget-settings"; currentPage = null;
      pageTitle.textContent = "âš™ï¸ Settings";
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ setÄƒrile...</div></div>';
      
      try {
        const r = await fetch(BACKEND_URL + '?action=getSettings');
        const d = await r.json();
        
        if (d.ok) {
          const s = d.data;
          
          content.innerHTML = `
            <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#6366F1,#4F46E5);">
              <h2>âš™ï¸ SetÄƒri Budget & AI</h2>
              <p>ConfigureazÄƒ bugetul È™i activeazÄƒ/dezactiveazÄƒ AI-urile</p>
            </div>
            
            <div class="card fade-in">
              <div class="card-title">ğŸ’° SetÄƒri Buget</div>
              
              <div class="form-group" style="margin-bottom:20px;">
                <label style="font-weight:600;margin-bottom:8px;display:block;">Buget Lunar (EUR):</label>
                <input type="number" id="setting-budget" class="input" value="${s.monthlyBudgetEUR || 50}" step="5" min="1" max="1000" style="max-width:200px;">
                <div style="font-size:12px;color:var(--text-soft);margin-top:5px;">Limita maximÄƒ de cheltuieli pe lunÄƒ</div>
              </div>
              
              <div class="grid-2" style="gap:20px;">
                <div class="form-group">
                  <label style="font-weight:600;margin-bottom:8px;display:block;">Warning Threshold (%):</label>
                  <input type="number" id="setting-warning" class="input" value="${s.budgetWarningPct || 80}" min="50" max="95">
                  <div style="font-size:12px;color:var(--text-soft);margin-top:5px;">AlertÄƒ galbenÄƒ la acest procent</div>
                </div>
                <div class="form-group">
                  <label style="font-weight:600;margin-bottom:8px;display:block;">Critical Threshold (%):</label>
                  <input type="number" id="setting-critical" class="input" value="${s.budgetCriticalPct || 95}" min="80" max="100">
                  <div style="font-size:12px;color:var(--text-soft);margin-top:5px;">AlertÄƒ roÈ™ie la acest procent</div>
                </div>
              </div>
            </div>
            
            <div class="card fade-in">
              <div class="card-title">ğŸ¤– Activare AI-uri</div>
              
              <div style="display:grid;gap:15px;">
                <label style="display:flex;align-items:center;gap:12px;padding:15px;background:var(--bg);border-radius:8px;cursor:pointer;">
                  <input type="checkbox" id="setting-openai" ${s.enableOpenAI ? 'checked' : ''} style="width:20px;height:20px;">
                  <div>
                    <div style="font-weight:600;">ğŸŸ¢ OpenAI (GPT-4o)</div>
                    <div style="font-size:12px;color:var(--text-soft);">Generare text SEO/Ads + structurÄƒ pagini</div>
                  </div>
                </label>
                
                <label style="display:flex;align-items:center;gap:12px;padding:15px;background:var(--bg);border-radius:8px;cursor:pointer;">
                  <input type="checkbox" id="setting-gemini" ${s.enableGemini ? 'checked' : ''} style="width:20px;height:20px;">
                  <div>
                    <div style="font-weight:600;">ğŸ”µ Gemini</div>
                    <div style="font-size:12px;color:var(--text-soft);">Optimizare titluri, meta descriptions, validare JSON</div>
                  </div>
                </label>
                
                <label style="display:flex;align-items:center;gap:12px;padding:15px;background:var(--bg);border-radius:8px;cursor:pointer;">
                  <input type="checkbox" id="setting-claude" ${s.enableClaude ? 'checked' : ''} style="width:20px;height:20px;">
                  <div>
                    <div style="font-weight:600;">ğŸŸ  Claude</div>
                    <div style="font-size:12px;color:var(--text-soft);">Chat natural cu clienÈ›ii</div>
                  </div>
                </label>
                
                <label style="display:flex;align-items:center;gap:12px;padding:15px;background:var(--bg);border-radius:8px;cursor:pointer;">
                  <input type="checkbox" id="setting-nanobanana" ${s.enableNanoBanana ? 'checked' : ''} style="width:20px;height:20px;">
                  <div>
                    <div style="font-weight:600;">ğŸŸ¡ Nano Banana</div>
                    <div style="font-size:12px;color:var(--text-soft);">Generare imagini pentru site</div>
                  </div>
                </label>
              </div>
            </div>
            
            <div style="display:flex;gap:10px;margin-top:20px;">
              <button class="btn btn-success" onclick="saveSettings()">ğŸ’¾ SalveazÄƒ SetÄƒrile</button>
              <button class="btn btn-secondary" onclick="showBudgetDashboard()">â† Ãnapoi la Dashboard</button>
            </div>
          `;
        }
      } catch (e) {
        content.innerHTML = `<div class="card"><div class="empty-state">âŒ Eroare: ${e.message}</div></div>`;
      }
    }
    
    async function saveSettings() {
      const budget = document.getElementById('setting-budget').value;
      const warning = document.getElementById('setting-warning').value;
      const critical = document.getElementById('setting-critical').value;
      const openai = document.getElementById('setting-openai').checked;
      const gemini = document.getElementById('setting-gemini').checked;
      const claude = document.getElementById('setting-claude').checked;
      const nanobanana = document.getElementById('setting-nanobanana').checked;
      
      try {
        const params = new URLSearchParams({
          action: 'updateSettings',
          monthlyBudgetEUR: budget,
          budgetWarningPct: warning,
          budgetCriticalPct: critical,
          enableOpenAI: openai,
          enableGemini: gemini,
          enableClaude: claude,
          enableNanoBanana: nanobanana
        });
        
        const r = await fetch(BACKEND_URL + '?' + params.toString());
        const d = await r.json();
        
        if (d.ok) {
          alert('âœ… SetÄƒrile au fost salvate!');
          showBudgetDashboard();
        } else {
          alert('âŒ Eroare: ' + (d.error || 'Unknown'));
        }
      } catch (e) {
        alert('âŒ Eroare: ' + e.message);
      }
    }
    
    async function showBudgetHistory() {
      currentGMPage = "budget-history"; currentPage = null;
      pageTitle.textContent = "ğŸ“œ Spend History";
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ istoricul...</div></div>';
      
      try {
        const r = await fetch(BACKEND_URL + '?action=getSpendHistory&limit=100');
        const d = await r.json();
        
        if (d.ok) {
          const history = d.data || [];
          
          let tableHtml = '';
          if (history.length === 0) {
            tableHtml = '<div class="empty-state">ğŸ“­ Nicio cheltuialÄƒ Ã®nregistratÄƒ Ã®ncÄƒ</div>';
          } else {
            tableHtml = `
              <table class="data-table">
                <thead>
                  <tr><th>Data/Ora</th><th>Provider</th><th>Model</th><th>AcÈ›iune</th><th>Cost (EUR)</th></tr>
                </thead>
                <tbody>
            `;
            
            history.forEach(h => {
              const providerColors = { openai: '#10B981', gemini: '#3B82F6', claude: '#F59E0B', nano_banana: '#8B5CF6' };
              const color = providerColors[h.provider] || '#6b7280';
              const date = h.timestamp ? new Date(h.timestamp).toLocaleString('ro-RO') : '-';
              
              tableHtml += `
                <tr>
                  <td style="font-size:12px;">${date}</td>
                  <td><span style="color:${color};font-weight:600;">${h.provider || 'unknown'}</span></td>
                  <td style="font-size:12px;">${h.model || '-'}</td>
                  <td>${h.route || '-'}</td>
                  <td style="font-weight:600;">â‚¬${parseFloat(h.costEUR || 0).toFixed(6)}</td>
                </tr>
              `;
            });
            
            tableHtml += '</tbody></table>';
          }
          
          content.innerHTML = `
            <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#8B5CF6,#7C3AED);">
              <h2>ğŸ“œ Istoric Cheltuieli</h2>
              <p>Toate costurile AI Ã®nregistrate</p>
            </div>
            
            <div class="card fade-in">
              <div class="card-title">ğŸ“Š Ultimele ${history.length} tranzacÈ›ii</div>
              ${tableHtml}
            </div>
            
            <button class="btn btn-secondary" onclick="showBudgetDashboard()">â† Ãnapoi la Dashboard</button>
          `;
        }
      } catch (e) {
        content.innerHTML = `<div class="card"><div class="empty-state">âŒ Eroare: ${e.message}</div></div>`;
      }
    }
    
    async function showBudgetErrors() {
      currentGMPage = "budget-errors"; currentPage = null;
      pageTitle.textContent = "âš ï¸ Errors";
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ erorile...</div></div>';
      
      try {
        const r = await fetch(BACKEND_URL + '?action=getRecentErrors&limit=50');
        const d = await r.json();
        
        if (d.ok) {
          const errors = d.data || [];
          
          let errorsHtml = '';
          if (errors.length === 0) {
            errorsHtml = '<div class="empty-state" style="color:#22c55e;">âœ… Nicio eroare! Totul funcÈ›ioneazÄƒ corect.</div>';
          } else {
            errors.forEach(e => {
              const severityColors = {
                'DEBUG': '#6b7280',
                'INFO': '#3b82f6',
                'WARNING': '#f59e0b',
                'ERROR': '#ef4444',
                'CRITICAL': '#dc2626'
              };
              const color = severityColors[e.severity] || '#6b7280';
              const date = e.timestamp ? new Date(e.timestamp).toLocaleString('ro-RO') : '-';
              
              errorsHtml += `
                <div style="padding:15px;background:var(--bg);border-radius:8px;margin-bottom:10px;border-left:4px solid ${color};">
                  <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                    <span style="font-weight:600;color:${color};">${e.severity}</span>
                    <span style="font-size:12px;color:var(--text-soft);">${date}</span>
                  </div>
                  <div style="font-weight:600;margin-bottom:5px;">${e.location || 'Unknown'}</div>
                  <div style="color:var(--text-soft);">${e.message || 'No message'}</div>
                </div>
              `;
            });
          }
          
          content.innerHTML = `
            <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#EF4444,#DC2626);">
              <h2>âš ï¸ Errors & Logs</h2>
              <p>Monitorizare erori sistem</p>
            </div>
            
            <div class="card fade-in">
              <div class="card-title">ğŸ“‹ Ultimele ${errors.length} erori</div>
              ${errorsHtml}
            </div>
            
            <button class="btn btn-secondary" onclick="showBudgetDashboard()">â† Ãnapoi la Dashboard</button>
          `;
        }
      } catch (e) {
        content.innerHTML = `<div class="card"><div class="empty-state">âŒ Eroare: ${e.message}</div></div>`;
      }
    }
    
    async function showSelfHealing() {
      currentGMPage = "self-healing"; currentPage = null;
      pageTitle.textContent = "ğŸ”§ Self-Healing System";
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ Self-Healing...</div></div>';
      
      try {
        // ÃncarcÄƒ status AI È™i pending fixes Ã®n paralel
        const [statusRes, pendingRes, fixLogRes, healthLogRes] = await Promise.all([
          fetch(BACKEND_URL + '?action=getAIStatus'),
          fetch(BACKEND_URL + '?action=getPendingFixes'),
          fetch(BACKEND_URL + '?action=getFixLog&limit=20'),
          fetch(BACKEND_URL + '?action=getHealthLog&limit=12')
        ]);
        
        const status = await statusRes.json();
        const pending = await pendingRes.json();
        const fixLog = await fixLogRes.json();
        const healthLog = await healthLogRes.json();
        
        // AI Status Cards
        const aiStatus = status.data || {};
        const providers = ['openai', 'gemini', 'claude', 'nano_banana'];
        const providerNames = { openai: 'GPT-4o', gemini: 'Gemini', claude: 'Claude', nano_banana: 'Nano Banana' };
        const providerEmojis = { openai: 'ğŸŸ¢', gemini: 'ğŸ”µ', claude: 'ğŸŸ ', nano_banana: 'ğŸŸ¡' };
        
        let statusCardsHtml = '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:15px;">';
        providers.forEach(p => {
          const s = aiStatus[p] || { status: 'unknown' };
          const isOk = s.status === 'ok';
          const bgColor = isOk ? '#f0fdf4' : (s.status === 'down' ? '#fef2f2' : '#f8fafc');
          const statusColor = isOk ? '#22c55e' : (s.status === 'down' ? '#ef4444' : '#6b7280');
          const statusText = isOk ? 'OK' : (s.status === 'down' ? 'DOWN' : 'Unknown');
          
          statusCardsHtml += `
            <div style="padding:20px;background:${bgColor};border-radius:12px;text-align:center;border:2px solid ${isOk ? '#bbf7d0' : (s.status === 'down' ? '#fecaca' : '#e2e8f0')};">
              <div style="font-size:32px;margin-bottom:8px;">${providerEmojis[p]}</div>
              <div style="font-weight:700;margin-bottom:5px;">${providerNames[p]}</div>
              <div style="font-size:18px;font-weight:700;color:${statusColor};">${statusText}</div>
              ${s.responseTime ? `<div style="font-size:12px;color:var(--text-soft);">${s.responseTime}ms</div>` : ''}
              ${s.consecutiveFails > 0 ? `<div style="font-size:11px;color:#ef4444;margin-top:5px;">âš ï¸ ${s.consecutiveFails} fails</div>` : ''}
            </div>
          `;
        });
        statusCardsHtml += '</div>';
        
        // Pending Fixes
        let pendingHtml = '';
        const pendingFixes = pending.data || [];
        if (pendingFixes.length > 0) {
          pendingHtml = `
            <div class="card fade-in" style="border:2px solid #f59e0b;background:#fffbeb;">
              <div class="card-title" style="color:#d97706;">â³ Fix-uri care aÈ™teaptÄƒ aprobare (${pendingFixes.length})</div>
          `;
          pendingFixes.forEach(fix => {
            pendingHtml += `
              <div style="padding:15px;background:white;border-radius:8px;margin-bottom:10px;border-left:4px solid #f59e0b;">
                <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                  <strong>ğŸ”§ ${fix.proposedFix?.description || 'Fix propus'}</strong>
                  <span style="font-size:12px;color:var(--text-soft);">${fix.timestamp ? new Date(fix.timestamp).toLocaleString('ro-RO') : ''}</span>
                </div>
                <div style="font-size:13px;color:var(--text-soft);margin-bottom:12px;">
                  âŒ Eroare: ${fix.error?.message || 'Unknown'}
                </div>
                <div style="display:flex;gap:10px;">
                  <button class="btn btn-success" onclick="approveFix('${fix.id}', true)">âœ… AprobÄƒ</button>
                  <button class="btn btn-error" onclick="approveFix('${fix.id}', false)">âŒ Respinge</button>
                </div>
              </div>
            `;
          });
          pendingHtml += '</div>';
        }
        
        // Fix Log
        let fixLogHtml = '<div class="empty-state">Niciun fix aplicat Ã®ncÄƒ</div>';
        const fixes = fixLog.data || [];
        if (fixes.length > 0) {
          fixLogHtml = '<div style="max-height:300px;overflow-y:auto;">';
          fixes.forEach(f => {
            const levelColors = {
              'LEVEL1_RETRY': '#3b82f6',
              'LEVEL2_FALLBACK': '#8b5cf6',
              'LEVEL2_SIMPLIFY': '#f59e0b',
              'LEVEL3_APPROVED': '#22c55e',
              'LEVEL4_ESCALATED': '#ef4444'
            };
            const color = levelColors[f.level] || '#6b7280';
            fixLogHtml += `
              <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid var(--border);">
                <div>
                  <span style="background:${color};color:white;padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600;">${f.level}</span>
                  <span style="margin-left:10px;">${f.description}</span>
                </div>
                <span style="font-size:12px;color:var(--text-soft);">${f.timestamp ? new Date(f.timestamp).toLocaleString('ro-RO') : ''}</span>
              </div>
            `;
          });
          fixLogHtml += '</div>';
        }
        
        // Health Log Timeline
        let healthHtml = '<div class="empty-state">Niciun health check Ã®ncÄƒ</div>';
        const healthChecks = healthLog.data || [];
        if (healthChecks.length > 0) {
          healthHtml = '<div style="max-height:250px;overflow-y:auto;">';
          healthChecks.forEach(h => {
            healthHtml += `
              <div style="display:flex;gap:10px;padding:8px 0;border-bottom:1px solid var(--border);font-size:13px;">
                <span style="color:var(--text-soft);min-width:120px;">${h.timestamp ? new Date(h.timestamp).toLocaleTimeString('ro-RO') : ''}</span>
                <span>${h.summary || '-'}</span>
              </div>
            `;
          });
          healthHtml += '</div>';
        }
        
        content.innerHTML = `
          <div class="welcome-card fade-in" style="background:linear-gradient(135deg,#8B5CF6,#6D28D9);">
            <h2>ğŸ”§ Self-Healing System</h2>
            <p>Monitorizare È™i reparare automatÄƒ AI-uri</p>
          </div>
          
          ${pendingHtml}
          
          <div class="card fade-in">
            <div class="card-title">
              ğŸ¤– AI Status (Live)
              <button class="btn btn-primary" onclick="runManualHealthCheck()" style="padding:5px 12px;font-size:13px;">ğŸ”„ VerificÄƒ Acum</button>
            </div>
            ${statusCardsHtml}
          </div>
          
          <div class="card fade-in">
            <div class="card-title">ğŸ“‹ Niveluri Self-Healing</div>
            <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;">
              <div style="padding:15px;background:#eff6ff;border-radius:8px;text-align:center;">
                <div style="font-size:24px;">ğŸ”„</div>
                <div style="font-weight:600;color:#3b82f6;">NIVEL 1</div>
                <div style="font-size:12px;color:var(--text-soft);">Retry automat (3x)</div>
              </div>
              <div style="padding:15px;background:#f5f3ff;border-radius:8px;text-align:center;">
                <div style="font-size:24px;">ğŸ”€</div>
                <div style="font-weight:600;color:#8b5cf6;">NIVEL 2</div>
                <div style="font-size:12px;color:var(--text-soft);">Switch la alt AI</div>
              </div>
              <div style="padding:15px;background:#fef3c7;border-radius:8px;text-align:center;">
                <div style="font-size:24px;">ğŸ“±</div>
                <div style="font-weight:600;color:#f59e0b;">NIVEL 3</div>
                <div style="font-size:12px;color:var(--text-soft);">WhatsApp aprobare</div>
              </div>
              <div style="padding:15px;background:#fef2f2;border-radius:8px;text-align:center;">
                <div style="font-size:24px;">ğŸš¨</div>
                <div style="font-weight:600;color:#ef4444;">NIVEL 4</div>
                <div style="font-size:12px;color:var(--text-soft);">Escalare manualÄƒ</div>
              </div>
            </div>
          </div>
          
          <div class="grid-2">
            <div class="card fade-in">
              <div class="card-title">ğŸ”§ Fix-uri Aplicate Recent</div>
              ${fixLogHtml}
            </div>
            
            <div class="card fade-in">
              <div class="card-title">ğŸ¥ Health Check History</div>
              ${healthHtml}
            </div>
          </div>
          
          <div style="display:flex;gap:10px;margin-top:20px;">
            <button class="btn btn-secondary" onclick="showBudgetDashboard()">â† Ãnapoi la Dashboard</button>
            <button class="btn btn-primary" onclick="setupHealthTrigger()">â° Setup Auto Health Check (1h)</button>
          </div>
        `;
        
      } catch (e) {
        content.innerHTML = `<div class="card"><div class="empty-state">âŒ Eroare: ${e.message}</div></div>`;
      }
    }
    
    async function runManualHealthCheck() {
      const btn = event.target;
      btn.disabled = true;
      btn.innerHTML = 'â³ Verificare...';
      
      try {
        const r = await fetch(BACKEND_URL + '?action=runHealthCheck');
        const d = await r.json();
        
        if (d.ok) {
          alert('âœ… Health check complet!');
          showSelfHealing();
        } else {
          alert('âŒ Eroare: ' + (d.error || 'Unknown'));
        }
      } catch (e) {
        alert('âŒ Eroare: ' + e.message);
      }
      
      btn.disabled = false;
      btn.innerHTML = 'ğŸ”„ VerificÄƒ Acum';
    }
    
    async function approveFix(fixId, approved) {
      try {
        const r = await fetch(BACKEND_URL + `?action=approveFix&fixId=${fixId}&approved=${approved}`);
        const d = await r.json();
        
        if (d.ok) {
          alert(approved ? 'âœ… Fix aplicat cu succes!' : 'âŒ Fix respins');
          showSelfHealing();
        } else {
          alert('âŒ Eroare: ' + (d.error || 'Unknown'));
        }
      } catch (e) {
        alert('âŒ Eroare: ' + e.message);
      }
    }
    
    async function setupHealthTrigger() {
      try {
        const r = await fetch(BACKEND_URL + '?action=setupHealthTrigger');
        const d = await r.json();
        
        if (d.ok) {
          alert('âœ… Health check automat setat! Va rula la fiecare orÄƒ.');
        } else {
          alert('âŒ Eroare: ' + (d.error || 'Unknown'));
        }
      } catch (e) {
        alert('âŒ Eroare: ' + e.message);
      }
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // USER MANAGEMENT - PÄ‚STRAT EXACT
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    async function showUsersAdmin() {
      currentGMPage = "users-admin"; currentPage = null;
      pageTitle.textContent = "Gestionare Utilizatori";
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ...</div></div>';
      try {
        const r = await fetch(BACKEND_URL + '?action=getAllUsers');
        const d = await r.json();
        if (d.ok) {
          let html = '<div class="card fade-in"><div class="card-title">ğŸ‘¥ Gestionare Utilizatori</div>';
          html += '<table class="data-table"><thead><tr><th>Nume</th><th>Email</th><th>Rol</th><th>Status</th><th>AcÈ›iuni</th></tr></thead><tbody>';
          (d.users || []).forEach(u => {
            const st = u.blocked ? 'ğŸ”’ Blocat' : (u.approved ? 'âœ… Activ' : 'â³ Ãn aÈ™teptare');
            const cl = u.blocked ? '#ef4444' : (u.approved ? '#22c55e' : '#f59e0b');
            html += `<tr><td>${u.name||''}</td><td>${u.email||''}</td><td>${u.role||''}</td>`;
            html += `<td style="color:${cl};font-weight:600;">${st}</td><td>`;
            if (!u.approved && !u.blocked) html += `<button class="btn btn-success" style="padding:5px 10px;" onclick="approveUser('${u.email}')">âœ…</button> `;
            if (u.approved && !u.blocked) html += `<button class="btn btn-error" style="padding:5px 10px;" onclick="blockUser('${u.email}')">ğŸ”’</button>`;
            if (u.blocked) html += `<button class="btn btn-primary" style="padding:5px 10px;" onclick="unblockUser('${u.email}')">âœ…</button>`;
            html += '</td></tr>';
          });
          html += '</tbody></table></div>';
          content.innerHTML = html;
        }
      } catch(e) { content.innerHTML = '<div class="card"><div class="empty-state">âŒ Eroare</div></div>'; }
    }
    
    async function showUsersGM() {
      currentGMPage = "users-gm"; currentPage = null;
      pageTitle.textContent = "Utilizatori (Full)";
      content.innerHTML = '<div class="card"><div class="loading"><div class="spinner"></div>Se Ã®ncarcÄƒ...</div></div>';
      try {
        const r = await fetch(BACKEND_URL + '?action=getAllUsers');
        const d = await r.json();
        if (d.ok) {
          let html = '<div class="card fade-in"><div class="card-title">ğŸ‘¥ Utilizatori (Full Control)</div>';
          html += '<table class="data-table"><thead><tr><th>Nume</th><th>Email</th><th>Rol</th><th>Status</th><th>Chat</th><th>AcÈ›iuni</th></tr></thead><tbody>';
          (d.users || []).forEach(u => {
            const st = u.blocked ? 'ğŸ”’ Blocat' : (u.approved ? 'âœ… Activ' : 'â³ Ãn aÈ™teptare');
            const cl = u.blocked ? '#ef4444' : (u.approved ? '#22c55e' : '#f59e0b');
            html += `<tr><td>${u.name||''}</td><td>${u.email||''}</td><td>${u.role||''}</td>`;
            html += `<td style="color:${cl};font-weight:600;">${st}</td>`;
            html += `<td><button class="btn btn-purple" style="padding:5px 10px;" onclick="viewUserChat('${u.email}')">ğŸ’¬</button></td><td>`;
            if (!u.approved && !u.blocked) html += `<button class="btn btn-success" style="padding:4px 8px;" onclick="approveUser('${u.email}')">âœ…</button> `;
            if (u.approved && !u.blocked) html += `<button class="btn btn-error" style="padding:4px 8px;" onclick="blockUser('${u.email}')">ğŸ”’</button> `;
            if (u.blocked) html += `<button class="btn btn-primary" style="padding:4px 8px;" onclick="unblockUser('${u.email}')">âœ…</button> `;
            html += `<button class="btn btn-error" style="padding:4px 8px;" onclick="deleteUser('${u.email}')">ğŸ—‘ï¸</button></td></tr>`;
          });
          html += '</tbody></table></div>';
          content.innerHTML = html;
        }
      } catch(e) { content.innerHTML = '<div class="card"><div class="empty-state">âŒ Eroare</div></div>'; }
    }
    
    async function approveUser(email) {
      if (!confirm('Aprobi utilizatorul?')) return;
      await fetch(BACKEND_URL + '?action=approveUser&email=' + encodeURIComponent(email));
      if (currentGMPage === 'users-admin') showUsersAdmin(); else showUsersGM();
      showToast('âœ… Utilizator aprobat!', 'success');
    }
    
    async function blockUser(email) {
      if (!confirm('Blochezi utilizatorul?')) return;
      await fetch(BACKEND_URL + '?action=blockUser&email=' + encodeURIComponent(email));
      if (currentGMPage === 'users-admin') showUsersAdmin(); else showUsersGM();
      showToast('ğŸ”’ Utilizator blocat', 'success');
    }
    
    async function unblockUser(email) {
      if (!confirm('Deblochezi utilizatorul?')) return;
      await fetch(BACKEND_URL + '?action=unblockUser&email=' + encodeURIComponent(email));
      if (currentGMPage === 'users-admin') showUsersAdmin(); else showUsersGM();
      showToast('âœ… Utilizator deblocat', 'success');
    }
    
    async function deleteUser(email) {
      if (!confirm('âš ï¸ È˜tergi definitiv utilizatorul?')) return;
      await fetch(BACKEND_URL + '?action=deleteUser&email=' + encodeURIComponent(email));
      showUsersGM();
      showToast('ğŸ—‘ï¸ Utilizator È™ters', 'success');
    }
    
    async function viewUserChat(email) {
      const r = await fetch(BACKEND_URL + '?action=getUserConversations&identifier=' + encodeURIComponent(email));
      const d = await r.json();
      let ch = '<div style="max-height:400px;overflow-y:auto;">';
      if (d.ok && d.conversations?.length > 0) {
        d.conversations.forEach(c => {
          ch += `<div style="margin-bottom:15px;"><div style="background:#ede9fe;padding:10px;border-radius:8px;margin-bottom:5px;"><b>ğŸ‘¤:</b> ${c.userMessage}</div><div style="background:#f3f4f6;padding:10px;border-radius:8px;"><b>ğŸ¤–:</b> ${c.aiResponse}</div></div>`;
        });
      } else { ch += '<p style="color:#6b7280;">Nicio conversaÈ›ie.</p>'; }
      ch += '</div>';
      document.body.insertAdjacentHTML('beforeend', `<div id="chatModal" style="position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:9999;display:flex;align-items:center;justify-content:center;" onclick="if(event.target===this)this.remove()"><div style="background:white;padding:25px;border-radius:16px;width:90%;max-width:600px;"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;"><h3>ğŸ’¬ ${email}</h3><button onclick="document.getElementById('chatModal').remove()" style="background:none;border:none;font-size:24px;cursor:pointer;">âœ•</button></div>${ch}</div></div>`);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // MODE COMMANDS & CHAT - PÄ‚STRAT EXACT
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    function updateModeUI() { renderNav(); }

    function handleModeCommands(text) {
      const lower = text.toLowerCase().trim();

      if (lower === "open mod andrei admin") {
        const pass = prompt("ğŸ” Parola Admin:");
        if (pass === ADMIN_PASSWORD) {
          currentMode = "admin";
          editMode = false;
          updateModeUI();
          pushMessage("ai", "âœ… Mod <b>Admin</b> activat!");
        } else {
          pushMessage("ai", "âŒ ParolÄƒ greÈ™itÄƒ!");
        }
        return true;
      }

      if (lower === "open mod andrei gm") {
        const pass = prompt("ğŸ” Parola GM:");
        if (pass === GM_PASSWORD) {
          currentMode = "gm";
          editMode = false;
          updateModeUI();
          pushMessage("ai", "âœ… Mod <b>GM</b> activat!<br><br>Vezi Ã®n sidebar: GM Core, SEO Command Center, Ads Command Center, Performance Hub!");
        } else {
          pushMessage("ai", "âŒ ParolÄƒ greÈ™itÄƒ!");
        }
        return true;
      }

      if (lower === "deschide mod editare" || lower === "editare") {
        if (currentMode === "admin" || currentMode === "gm") {
          editMode = true;
          pushMessage("ai", "âœï¸ <b>Mod editare activ!</b>");
        } else {
          pushMessage("ai", "âš ï¸ Trebuie sÄƒ fii Ã®n mod Admin sau GM.");
        }
        return true;
      }

      if (lower === "inchide mod editare" || lower === "gata") {
        editMode = false;
        pushMessage("ai", "âœ… Mod editare Ã®nchis.");
        return true;
      }

      if (lower === "exit" || lower === "iesi") {
        currentMode = "standard";
        editMode = false;
        updateModeUI();
        pushMessage("ai", "ğŸ‘‹ Ai ieÈ™it din mod special.");
        return true;
      }
      
      if (lower === "intra in mod logare" || lower === "intrÄƒ Ã®n mod logare") {
        chatWindow.classList.add('hidden');
        showLoginForm();
        return true;
      }

      return false;
    }
    
    function showLoginForm() {
      document.body.insertAdjacentHTML('beforeend', `
        <div id="loginOverlay" style="position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:9999;display:flex;align-items:center;justify-content:center;">
          <div style="background:white;padding:30px;border-radius:16px;width:90%;max-width:400px;">
            <div id="loginBox">
              <h2 style="text-align:center;margin-bottom:20px;">ğŸ” Autentificare</h2>
              <input type="email" id="loginEmail" placeholder="ğŸ“§ Email" class="input" style="margin-bottom:10px;">
              <input type="password" id="loginPass" placeholder="ğŸ”’ ParolÄƒ" class="input" style="margin-bottom:15px;">
              <button onclick="doLogin()" class="btn btn-primary" style="width:100%;margin-bottom:10px;">ğŸš€ IntrÄƒ</button>
              <button onclick="showRegBox()" class="btn btn-secondary" style="width:100%;">âœ¨ ÃnregistreazÄƒ-te</button>
              <button onclick="closeLogin()" style="width:100%;padding:10px;background:none;border:none;color:#6b7280;cursor:pointer;margin-top:10px;">âœ• Ãnchide</button>
            </div>
            <div id="regBox" style="display:none;">
              <h2 style="text-align:center;margin-bottom:20px;">âœ¨ ÃnregistreazÄƒ-te</h2>
              <input type="text" id="regName" placeholder="ğŸ‘¤ Nume" class="input" style="margin-bottom:10px;">
              <input type="email" id="regEmail" placeholder="ğŸ“§ Email" class="input" style="margin-bottom:10px;">
              <input type="password" id="regPass" placeholder="ğŸ”’ ParolÄƒ" class="input" style="margin-bottom:10px;">
              <input type="password" id="regPass2" placeholder="ğŸ”’ RepetÄƒ parola" class="input" style="margin-bottom:10px;">
              <select id="regRole" class="select" style="margin-bottom:15px;">
                <option value="Animator">Animator</option><option value="È˜ofer">È˜ofer</option><option value="Trainer">Trainer</option>
              </select>
              <button onclick="doRegister()" class="btn btn-success" style="width:100%;margin-bottom:10px;">âœ¨ CreeazÄƒ cont</button>
              <button onclick="showLoginBox()" class="btn btn-secondary" style="width:100%;">ğŸ‘¤ Am deja cont</button>
            </div>
          </div>
        </div>
      `);
    }
    
    function showRegBox() { document.getElementById('loginBox').style.display='none'; document.getElementById('regBox').style.display='block'; }
    function showLoginBox() { document.getElementById('loginBox').style.display='block'; document.getElementById('regBox').style.display='none'; }
    function closeLogin() { document.getElementById('loginOverlay')?.remove(); }
    
    function logoutUser() {
      if (confirm('Sigur vrei sÄƒ ieÈ™i din cont?')) {
        clearUserSession();
        showToast('ğŸ‘‹ Te-ai delogat!', 'info');
        location.reload();
      }
    }
    
    async function doLogin() {
      const email = document.getElementById('loginEmail').value.trim();
      const pass = document.getElementById('loginPass').value;
      if (!email || !pass) { showToast('CompleteazÄƒ email È™i parola!', 'warning'); return; }
      try {
        const r = await fetch(BACKEND_URL + '?action=login&email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(pass));
        const d = await r.json();
        if (d.ok && d.user) {
          if (!d.user.approved) { showToast('Contul aÈ™teaptÄƒ aprobarea.', 'warning'); return; }
          if (d.user.blocked) { showToast('Contul este blocat.', 'error'); return; }
          saveUserSession(d.user);
          closeLogin();
          showToast('âœ… Bine ai venit, ' + d.user.name + '!', 'success');
          renderNav();
          showUserHome();
        } else { showToast('Email sau parolÄƒ incorectÄƒ!', 'error'); }
      } catch(e) { showToast('Eroare: ' + e.message, 'error'); }
    }
    
    async function doRegister() {
      const name = document.getElementById('regName').value.trim();
      const email = document.getElementById('regEmail').value.trim();
      const pass = document.getElementById('regPass').value;
      const pass2 = document.getElementById('regPass2').value;
      const role = document.getElementById('regRole').value;
      if (!name || !email || !pass) { showToast('CompleteazÄƒ toate cÃ¢mpurile!', 'warning'); return; }
      if (pass !== pass2) { showToast('Parolele nu coincid!', 'warning'); return; }
      try {
        const r = await fetch(BACKEND_URL + '?action=register&name=' + encodeURIComponent(name) + '&email=' + encodeURIComponent(email) + '&password=' + encodeURIComponent(pass) + '&role=' + encodeURIComponent(role));
        const d = await r.json();
        if (d.ok) { showToast('âœ… Cont creat! AÈ™teaptÄƒ aprobarea.', 'success'); showLoginBox(); }
        else { showToast(d.error || 'Eroare', 'error'); }
      } catch(e) { showToast('Eroare: ' + e.message, 'error'); }
    }

    function pushMessage(type, html) {
      const div = document.createElement("div");
      div.className = "chat-msg " + type;
      div.innerHTML = html;
      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    async function handleChatSend() {
      const text = chatInput.value.trim();
      if (!text) return;

      chatInput.value = "";
      pushMessage("user", text);

      if (handleModeCommands(text)) return;

      const scanRequest = detectScanRequest(text);
      if (scanRequest && currentMode === "standard") {
        openScanPopup(scanRequest.nume, "ScaneazÄƒ " + scanRequest.nume);
        pushMessage("ai", "ğŸ“· ÃncarcÄƒ documentul pentru a continua.");
        return;
      }

      pushMessage("ai", "â³ Procesez...");

      try {
        let url = BACKEND_URL + "?action=chat&message=" + encodeURIComponent(text);
        if (currentMode === "gm") url += "&mode=gm&password=" + encodeURIComponent(GM_PASSWORD) + "&editMode=" + editMode;
        else if (currentMode === "admin") url += "&mode=admin&password=" + encodeURIComponent(ADMIN_PASSWORD);

        const response = await fetch(url);
        const data = await response.json();

        const msgs = chatMessages.querySelectorAll(".chat-msg.ai");
        const last = msgs[msgs.length - 1];
        if (last?.textContent.includes("Procesez")) last.remove();

        if (data.ok && data.reply) {
          let reply = data.reply.replace(/\*\*(.+?)\*\*/g, '<b>$1</b>').replace(/`([^`]+)`/g, '<code>$1</code>').replace(/\n/g, '<br>');
          pushMessage("ai", reply);
          if (data.reload) setTimeout(() => loadApp(), 500);
          if (data.requestUpload) openScanPopup(data.scanType, "ÃncarcÄƒ document");
        } else {
          pushMessage("ai", "âš ï¸ " + (data.error || "Eroare"));
        }
      } catch (e) {
        const msgs = chatMessages.querySelectorAll(".chat-msg.ai");
        const last = msgs[msgs.length - 1];
        if (last?.textContent.includes("Procesez")) last.remove();
        pushMessage("ai", "âš ï¸ Eroare conexiune");
      }
    }

    function detectScanRequest(text) {
      const lower = text.toLowerCase();
      if (lower.includes("scanez") || lower.includes("notez") || lower.includes("Ã®ncarcÄƒ")) {
        const scans = appData.scanari || [];
        for (const s of scans) {
          if (lower.includes(s.nume.toLowerCase())) return s;
        }
        if (lower.includes("petrecere") || lower.includes("rezerv")) {
          return { nume: "Petreceri", campuri: "Nume,Telefon,Data,Ora,Locatie" };
        }
      }
      return null;
    }

    function openScanPopup(scanType, title) {
      currentScanType = scanType;
      document.getElementById("scanPopupTitle").textContent = "ğŸ“· " + title;
      scanPopup.classList.add("active");
      overlay.classList.add("active");
      uploadArea.style.display = "block";
      scanStatus.style.display = "none";
    }

    function closeScanPopup() {
      scanPopup.classList.remove("active");
      overlay.classList.remove("active");
    }

    uploadArea.addEventListener("click", () => fileInput.click());
    fileInput.addEventListener("change", (e) => { if (e.target.files[0]) handleFileUpload(e.target.files[0]); });

    async function handleFileUpload(file) {
      uploadArea.style.display = "none";
      scanStatus.style.display = "block";
      scanStatus.innerHTML = "â³ Se scaneazÄƒ...";

      try {
        const base64 = await new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = () => resolve(reader.result.split(",")[1]);
          reader.onerror = reject;
          reader.readAsDataURL(file);
        });

        const response = await fetch(BACKEND_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ action: "scanDocument", scanType: currentScanType, image: base64, fileName: file.name, mode: currentMode })
        });

        const data = await response.json();

        if (data.ok) {
          closeScanPopup();
          pushMessage("ai", "âœ… <b>Scanat È™i salvat!</b><br><br>" + data.message.replace(/\n/g, '<br>'));
          setTimeout(() => loadApp(), 500);
        } else {
          scanStatus.innerHTML = "âŒ " + (data.error || "Eroare");
        }
      } catch (e) {
        scanStatus.innerHTML = "âŒ Eroare la Ã®ncÄƒrcare";
      }
    }

    // ===== INIT =====
    loadApp();
    pushMessage("ai", "Salut! ğŸ‘‹ Sunt AI-ul SuperParty. Cu ce te pot ajuta?");

</script>
</body>
</html>
</body>
</html>
