<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>SuperParty</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <style>
    :root {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --primary-light: #60a5fa;
      --bg: #f8fafc;
      --bg-alt: #ffffff;
      --card: #ffffff;
      --border: #e2e8f0;
      --text: #1e293b;
      --text-soft: #64748b;
      --text-muted: #94a3b8;
      --success: #22c55e;
      --danger: #ef4444;
      --warning: #f59e0b;
      --radius: 12px;
      --shadow: 0 4px 20px rgba(0,0,0,0.08);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* ===== LAYOUT ===== */
    .app {
      display: flex;
      min-height: 100vh;
    }

    /* ===== SIDEBAR ===== */
    .sidebar {
      width: 280px;
      background: var(--bg-alt);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 100;
      transition: transform 0.3s ease;
    }

    .sidebar.hidden-mobile {
      transform: translateX(-100%);
    }

    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      font-size: 18px;
    }

    .logo-text {
      font-size: 18px;
      font-weight: 700;
      color: var(--text);
    }

    .logo-sub {
      font-size: 11px;
      color: var(--text-muted);
    }

    .sidebar-nav {
      flex: 1;
      padding: 15px 10px;
      overflow-y: auto;
    }

    .nav-section {
      margin-bottom: 20px;
    }

    .nav-section-title {
      font-size: 11px;
      text-transform: uppercase;
      color: var(--text-muted);
      padding: 8px 12px;
      letter-spacing: 0.5px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 15px;
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.2s;
      color: var(--text-soft);
      font-size: 14px;
    }

    .nav-item:hover {
      background: var(--bg);
      color: var(--text);
    }

    .nav-item.active {
      background: var(--primary);
      color: white;
    }

    .nav-item .icon {
      font-size: 18px;
    }

    .nav-group {
      display: none;
    }

    .nav-group.visible {
      display: block;
    }

    .sidebar-footer {
      padding: 15px;
      border-top: 1px solid var(--border);
    }

    .mode-status {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      background: var(--bg);
      border-radius: var(--radius);
      font-size: 13px;
    }

    .mode-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--text-muted);
    }

    .mode-dot.active {
      background: var(--success);
    }

    /* ===== MAIN CONTENT ===== */
    .main {
      flex: 1;
      margin-left: 280px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* ===== HEADER ===== */
    .header {
      background: var(--bg-alt);
      border-bottom: 1px solid var(--border);
      padding: 15px 25px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 50;
    }

    .menu-btn {
      display: none;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      padding: 5px;
      color: var(--text);
    }

    .page-title {
      font-size: 18px;
      font-weight: 600;
    }

    .header-actions {
      display: flex;
      gap: 10px;
    }

    /* ===== CONTENT ===== */
    .content {
      flex: 1;
      padding: 25px;
    }

    .page {
      display: none;
    }

    .page.active {
      display: block;
    }

    /* ===== HOME PAGE ===== */
    .welcome-card {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: var(--radius);
      padding: 30px;
      color: white;
      margin-bottom: 25px;
    }

    .welcome-card h2 {
      font-size: 24px;
      margin-bottom: 8px;
    }

    .welcome-card p {
      opacity: 0.9;
      font-size: 14px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .stat-card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 20px;
      box-shadow: var(--shadow);
    }

    .stat-card .label {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 8px;
    }

    .stat-card .value {
      font-size: 28px;
      font-weight: 700;
      color: var(--primary);
    }

    /* ===== CHAT BUTTON ===== */
    .chat-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: 50%;
      border: none;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
      color: white;
      z-index: 200;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .chat-toggle:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 25px rgba(59, 130, 246, 0.5);
    }

    /* ===== CHAT WINDOW ===== */
    .chat-window {
      position: fixed;
      bottom: 90px;
      right: 20px;
      width: 380px;
      height: 500px;
      background: var(--bg-alt);
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      display: flex;
      flex-direction: column;
      z-index: 199;
      overflow: hidden;
      transition: opacity 0.2s, transform 0.2s;
    }

    .chat-window.hidden {
      opacity: 0;
      transform: translateY(20px) scale(0.95);
      pointer-events: none;
    }

    .chat-header {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .chat-header-title {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .chat-header h3 {
      font-size: 15px;
      font-weight: 600;
    }

    .chat-mode-label {
      font-size: 11px;
      background: rgba(255,255,255,0.2);
      padding: 3px 8px;
      border-radius: 10px;
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 15px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .chat-msg {
      max-width: 85%;
      padding: 10px 14px;
      border-radius: 12px;
      font-size: 14px;
      line-height: 1.4;
    }

    .chat-msg.user {
      background: var(--primary);
      color: white;
      align-self: flex-end;
      border-bottom-right-radius: 4px;
    }

    .chat-msg.ai {
      background: var(--bg);
      color: var(--text);
      align-self: flex-start;
      border-bottom-left-radius: 4px;
    }

    .chat-msg .time {
      font-size: 10px;
      opacity: 0.7;
      margin-top: 4px;
    }

    .chat-input-area {
      padding: 15px;
      border-top: 1px solid var(--border);
      display: flex;
      gap: 10px;
    }

    .chat-input {
      flex: 1;
      border: 1px solid var(--border);
      border-radius: 25px;
      padding: 10px 18px;
      font-size: 14px;
      outline: none;
      transition: border-color 0.2s;
    }

    .chat-input:focus {
      border-color: var(--primary);
    }

    .chat-send {
      width: 44px;
      height: 44px;
      background: var(--primary);
      border: none;
      border-radius: 50%;
      cursor: pointer;
      color: white;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    .chat-send:hover {
      background: var(--primary-dark);
    }

    /* ===== OVERLAY ===== */
    .overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      z-index: 99;
    }

    .overlay.active {
      display: block;
    }

    /* ===== MOBILE RESPONSIVE ===== */
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main {
        margin-left: 0;
      }

      .menu-btn {
        display: block;
      }

      .header {
        padding: 12px 15px;
      }

      .content {
        padding: 15px;
      }

      .chat-window {
        right: 10px;
        left: 10px;
        bottom: 80px;
        width: auto;
        height: calc(100vh - 160px);
        max-height: 500px;
      }

      .chat-toggle {
        bottom: 15px;
        right: 15px;
        width: 55px;
        height: 55px;
      }

      .welcome-card {
        padding: 20px;
      }

      .welcome-card h2 {
        font-size: 20px;
      }
    }

    /* ===== ANIMATIONS ===== */
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .chat-msg {
      animation: slideIn 0.2s ease;
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="logo">SP</div>
        <div>
          <div class="logo-text">SuperParty</div>
          <div class="logo-sub">Management</div>
        </div>
      </div>

      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Meniu</div>
          <div class="nav-item active" data-page="home">
            <span class="icon">üè†</span>
            <span>AcasƒÉ</span>
          </div>
        </div>

        <!-- ADMIN GROUP -->
        <div class="nav-section nav-group" id="adminNavGroup">
          <div class="nav-section-title">Admin</div>
          <div class="nav-item" data-page="admin-users">
            <span class="icon">üë•</span>
            <span>Utilizatori</span>
          </div>
        </div>

        <!-- GM GROUP -->
        <div class="nav-section nav-group" id="gmNavGroup">
          <div class="nav-section-title">GM Panel</div>
          <div class="nav-item" data-page="gm-panel">
            <span class="icon">‚öôÔ∏è</span>
            <span>GM Panel</span>
          </div>
        </div>
      </nav>

      <div class="sidebar-footer">
        <div class="mode-status">
          <span class="mode-dot" id="modeDot"></span>
          <span>Mod: <strong id="modeLabel">Standard</strong></span>
        </div>
      </div>
    </aside>

    <!-- OVERLAY (mobile) -->
    <div class="overlay" id="overlay"></div>

    <!-- MAIN -->
    <main class="main">
      <header class="header">
        <button class="menu-btn" id="menuBtn">‚ò∞</button>
        <h1 class="page-title" id="pageTitle">AcasƒÉ</h1>
        <div class="header-actions"></div>
      </header>

      <div class="content">
        <!-- HOME PAGE -->
        <section class="page active" id="page-home">
          <div class="welcome-card">
            <h2>Bine ai venit! üëã</h2>
            <p>Aplica»õia ta SuperParty este gata. Folose»ôte chat-ul pentru a o personaliza.</p>
          </div>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="label">Status</div>
              <div class="value" style="font-size: 18px; color: var(--success);">‚úì Conectat</div>
            </div>
            <div class="stat-card">
              <div class="label">Mod curent</div>
              <div class="value" style="font-size: 18px;" id="homeModLabel">Standard</div>
            </div>
          </div>
        </section>

        <!-- ADMIN PAGE -->
        <section class="page" id="page-admin-users">
          <div class="welcome-card" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
            <h2>Admin Panel üîê</h2>
            <p>Management utilizatori »ôi setƒÉri</p>
          </div>
        </section>

        <!-- GM PAGE -->
        <section class="page" id="page-gm-panel">
          <div class="welcome-card" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">
            <h2>GM Panel ‚öôÔ∏è</h2>
            <p>ModificƒÉ aplica»õia din chat. Scrie comenzi pentru a adƒÉuga/»ôterge/modifica elemente.</p>
          </div>
          <div class="stat-card" style="margin-top: 20px;">
            <div class="label">Comenzi rapide</div>
            <div style="font-size: 13px; color: var(--text-soft); line-height: 1.8; margin-top: 10px;">
              ‚Ä¢ <code>culoare sidebar rosu</code> - schimbƒÉ culoare<br>
              ‚Ä¢ <code>titlu Nume Nou</code> - schimbƒÉ titlul<br>
              ‚Ä¢ <code>versiuni</code> - vezi istoric<br>
              ‚Ä¢ <code>undo</code> - anuleazƒÉ modificare<br>
              ‚Ä¢ <code>ajutor</code> - toate comenzile
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <!-- CHAT TOGGLE -->
  <button class="chat-toggle" id="chatToggle">üí¨</button>

  <!-- CHAT WINDOW -->
  <div class="chat-window hidden" id="chatWindow">
    <div class="chat-header">
      <div class="chat-header-title">
        <span>ü§ñ</span>
        <h3>SuperParty AI</h3>
      </div>
      <span class="chat-mode-label" id="chatModeLabel">Standard</span>
    </div>
    <div class="chat-messages" id="chatMessages"></div>
    <div class="chat-input-area">
      <input type="text" class="chat-input" id="chatInput" placeholder="Scrie un mesaj...">
      <button class="chat-send" id="chatSend">‚û§</button>
    </div>
  </div>

  <script>
    // ===== CONFIG =====
    const BACKEND_URL = "https://script.google.com/macros/s/AKfycbyfyw63pxz5z6hW0abaQXEvu1aU1OPSykc2v8Jz23-z2RFY14rw1zU90ETUEn8TLZXd/exec";
    const GM_PASSWORD = "Gmandrei209512!";
    const ADMIN_PASSWORD = "Adminandrei209512!";

    // ===== STATE =====
    let currentPage = "home";
    let currentMode = "standard";

    // ===== ELEMENTS =====
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("overlay");
    const menuBtn = document.getElementById("menuBtn");
    const pageTitle = document.getElementById("pageTitle");
    const chatToggle = document.getElementById("chatToggle");
    const chatWindow = document.getElementById("chatWindow");
    const chatMessages = document.getElementById("chatMessages");
    const chatInput = document.getElementById("chatInput");
    const chatSend = document.getElementById("chatSend");

    // ===== MOBILE MENU =====
    menuBtn.addEventListener("click", () => {
      sidebar.classList.add("open");
      overlay.classList.add("active");
    });

    overlay.addEventListener("click", () => {
      sidebar.classList.remove("open");
      overlay.classList.remove("active");
    });

    // ===== NAVIGATION =====
    document.querySelectorAll(".nav-item").forEach(item => {
      item.addEventListener("click", () => {
        const page = item.dataset.page;
        if (!page) return;

        // Update nav
        document.querySelectorAll(".nav-item").forEach(i => i.classList.remove("active"));
        item.classList.add("active");

        // Update page
        document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
        document.getElementById("page-" + page)?.classList.add("active");

        // Update title
        pageTitle.textContent = item.querySelector("span:last-child").textContent;
        currentPage = page;

        // Close mobile menu
        sidebar.classList.remove("open");
        overlay.classList.remove("active");
      });
    });

    // ===== MODE UI =====
    function updateModeUI() {
      const modeLabel = document.getElementById("modeLabel");
      const modeDot = document.getElementById("modeDot");
      const chatModeLabel = document.getElementById("chatModeLabel");
      const homeModLabel = document.getElementById("homeModLabel");
      const adminNav = document.getElementById("adminNavGroup");
      const gmNav = document.getElementById("gmNavGroup");

      modeLabel.textContent = currentMode.charAt(0).toUpperCase() + currentMode.slice(1);
      chatModeLabel.textContent = modeLabel.textContent;
      homeModLabel.textContent = modeLabel.textContent;

      modeDot.classList.toggle("active", currentMode !== "standard");

      adminNav.classList.toggle("visible", currentMode === "admin");
      gmNav.classList.toggle("visible", currentMode === "gm");
    }

    // ===== CHAT =====
    chatToggle.addEventListener("click", () => {
      chatWindow.classList.toggle("hidden");
      if (!chatWindow.classList.contains("hidden")) {
        chatInput.focus();
      }
    });

    function pushMessage(role, text) {
      const div = document.createElement("div");
      div.className = "chat-msg " + role;
      div.innerHTML = text + '<div class="time">' + new Date().toLocaleTimeString("ro-RO", {hour: "2-digit", minute: "2-digit"}) + '</div>';
      chatMessages.appendChild(div);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function handleModeCommands(text) {
      const lower = text.toLowerCase().trim();

      if (lower === "open mod andrei admin") {
        const pass = prompt("üîê Parola Admin:");
        if (pass === ADMIN_PASSWORD) {
          currentMode = "admin";
          updateModeUI();
          pushMessage("ai", "‚úÖ Mod <b>Admin</b> activat!");
        } else {
          pushMessage("ai", "‚ùå ParolƒÉ gre»ôitƒÉ!");
        }
        return true;
      }

      if (lower === "open mod andrei gm") {
        const pass = prompt("üîê Parola GM:");
        if (pass === GM_PASSWORD) {
          currentMode = "gm";
          updateModeUI();
          pushMessage("ai", "‚úÖ Mod <b>GM</b> activat! Po»õi modifica aplica»õia din chat.");
        } else {
          pushMessage("ai", "‚ùå ParolƒÉ gre»ôitƒÉ!");
        }
        return true;
      }

      if (lower === "iesi din mod admin" || lower === "iesi din mod gm" || lower === "exit") {
        currentMode = "standard";
        updateModeUI();
        pushMessage("ai", "üëã Revenit la mod Standard.");
        return true;
      }

      return false;
    }

    async function handleChatSend() {
      const text = chatInput.value.trim();
      if (!text) return;

      chatInput.value = "";
      pushMessage("user", text);

      if (handleModeCommands(text)) return;

      pushMessage("ai", "‚è≥ MƒÉ g√¢ndesc...");

      try {
        let url = BACKEND_URL + "?action=chat&message=" + encodeURIComponent(text);
        if (currentMode === "gm") {
          url += "&mode=gm&password=" + encodeURIComponent(GM_PASSWORD);
        }

        const response = await fetch(url);
        const data = await response.json();

        // Remove thinking message
        const msgs = chatMessages.querySelectorAll(".chat-msg.ai");
        const last = msgs[msgs.length - 1];
        if (last && last.textContent.includes("g√¢ndesc")) {
          last.remove();
        }

        if (data.ok && data.reply) {
          let reply = data.reply.replace(/\*\*(.+?)\*\*/g, '<b>$1</b>').replace(/\n/g, '<br>');
          pushMessage("ai", reply);
        } else {
          pushMessage("ai", "‚ö†Ô∏è " + (data.error || "Eroare necunoscutƒÉ"));
        }
      } catch (e) {
        const msgs = chatMessages.querySelectorAll(".chat-msg.ai");
        const last = msgs[msgs.length - 1];
        if (last && last.textContent.includes("g√¢ndesc")) {
          last.remove();
        }
        pushMessage("ai", "‚ö†Ô∏è Eroare conexiune.");
      }
    }

    chatSend.addEventListener("click", handleChatSend);
    chatInput.addEventListener("keydown", e => {
      if (e.key === "Enter") handleChatSend();
    });

    // ===== INIT =====
    updateModeUI();
    pushMessage("ai", "Salut! üëã Sunt AI-ul SuperParty. Cu ce te pot ajuta?");
  </script>
</body>
</html>
